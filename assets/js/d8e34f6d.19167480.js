"use strict";(globalThis.webpackChunkosism=globalThis.webpackChunkosism||[]).push([[9583],{9397(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"guides/operations-guide/node/package-upgrades","title":"Package Upgrades","description":"Compute Nodes","source":"@site/docs/guides/operations-guide/node/package-upgrades.md","sourceDirName":"guides/operations-guide/node","slug":"/guides/operations-guide/node/package-upgrades","permalink":"/docs/guides/operations-guide/node/package-upgrades","draft":false,"unlisted":false,"editUrl":"https://github.com/osism/osism.github.io/tree/main/docs/guides/operations-guide/node/package-upgrades.md","tags":[],"version":"current","frontMatter":{"sidebar_label":"Package Upgrades"},"sidebar":"tutorialSidebar","previous":{"title":"Node","permalink":"/docs/guides/operations-guide/node/"},"next":{"title":"OpenStack","permalink":"/docs/guides/operations-guide/openstack/"}}');var o=s(4848),i=s(8453);const r={sidebar_label:"Package Upgrades"},t="Package Upgrades",c={},d=[{value:"Compute Nodes",id:"compute-nodes",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"package-upgrades",children:"Package Upgrades"})}),"\n",(0,o.jsx)(n.h2,{id:"compute-nodes",children:"Compute Nodes"}),"\n",(0,o.jsx)(n.p,{children:"Set HOST environment to be used in subsequent commands to the compute node which is going to be updated"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:'HOST=""\n'})}),"\n",(0,o.jsx)(n.p,{children:"Disable compute host, so that no new instances are scheduled to it and instance state remains unchanged"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"osism manage compute disable $HOST\n"})}),"\n",(0,o.jsx)(n.p,{children:"Live-migrate all instances to other compute nodes"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"osism manage compute migrate --yes $HOST\n"})}),"\n",(0,o.jsx)(n.p,{children:"List remaining nodes in non-live-migratable state"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"osism manage compute list $HOST\n"})}),"\n",(0,o.jsx)(n.p,{children:"Move shut off nodes to other nodes"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"INTERACTIVE=false openstack server list --all-projects --status SHUTOFF --host $HOST -f value -c ID | while read -r ID; do openstack server migrate $ID; done\n"})}),"\n",(0,o.jsx)(n.p,{children:"Show migrations"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"openstack server migration list --host $HOST --changes-since 2025-04-15\n"})}),"\n",(0,o.jsx)(n.p,{children:"and confirm resize for all finished migrations individually"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"openstack server resize confirm #SERVER\n"})}),"\n",(0,o.jsx)(n.p,{children:"Check for remaining nodes in unmigratable states"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"osism manage compute list $HOST\n"})}),"\n",(0,o.jsx)(n.p,{children:"Apply package upgrades"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"osism apply upgrade-packages -e ireallymeanit=yes --limit $HOST\n"})}),"\n",(0,o.jsx)(n.p,{children:"Optionally reboot the node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"osism apply reboot -e ireallymeanit=yes -e reboot_wait=yes --limit $HOST\n"})}),"\n",(0,o.jsx)(n.p,{children:"Re-enable the compute node"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-console",children:"osism manage compute enable $HOST\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453(e,n,s){s.d(n,{R:()=>r,x:()=>t});var a=s(6540);const o={},i=a.createContext(o);function r(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);