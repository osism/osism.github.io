"use strict";(globalThis.webpackChunkosism=globalThis.webpackChunkosism||[]).push([[486],{8469(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"appendix/security/ossa-2026-001","title":"OSSA-2026-001: Privilege Escalation via Identity Headers in External OAuth2 Tokens","description":"| Property         | Value                                                             |","source":"@site/docs/appendix/security/ossa-2026-001.md","sourceDirName":"appendix/security","slug":"/appendix/security/ossa-2026-001","permalink":"/docs/appendix/security/ossa-2026-001","draft":false,"unlisted":false,"editUrl":"https://github.com/osism/osism.github.io/tree/main/docs/appendix/security/ossa-2026-001.md","tags":[],"version":"current","frontMatter":{"sidebar_label":"OSSA-2026-001"},"sidebar":"tutorialSidebar","previous":{"title":"Security","permalink":"/docs/appendix/security/"},"next":{"title":"OSSA-2026-002","permalink":"/docs/appendix/security/ossa-2026-002"}}');var s=t(4848),l=t(8453);const r={sidebar_label:"OSSA-2026-001"},o="OSSA-2026-001: Privilege Escalation via Identity Headers in External OAuth2 Tokens",d={},a=[{value:"Summary",id:"summary",level:2},{value:"Affected Versions",id:"affected-versions",level:2},{value:"Impact on OSISM",id:"impact-on-osism",level:2},{value:"How to Check if You Are Affected",id:"how-to-check-if-you-are-affected",level:3},{value:"Check in the Configuration Repository",id:"check-in-the-configuration-repository",level:4},{value:"Check on the Running Deployment",id:"check-on-the-running-deployment",level:4},{value:"Vulnerability Details",id:"vulnerability-details",level:2},{value:"Remediation",id:"remediation",level:2},{value:"For OSISM Releases",id:"for-osism-releases",level:3},{value:"Mitigation",id:"mitigation",level:3},{value:"References",id:"references",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ossa-2026-001-privilege-escalation-via-identity-headers-in-external-oauth2-tokens",children:"OSSA-2026-001: Privilege Escalation via Identity Headers in External OAuth2 Tokens"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Property"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Date"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"2026-01-15 (Errata: 2026-01-16)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"CVE"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.a,{href:"https://www.cve.org/CVERecord?id=CVE-2026-22797",children:"CVE-2026-22797"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Severity"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"High"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Affected Project"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"keystonemiddleware"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Reporter"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Grzegorz Grasza (Red Hat)"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(n.p,{children:["A critical vulnerability was discovered in the ",(0,s.jsx)(n.code,{children:"external_oauth2_token"})," middleware of OpenStack\nkeystonemiddleware. The middleware fails to sanitize incoming authentication headers before\nprocessing OAuth 2.0 tokens, allowing authenticated attackers to escalate privileges or\nimpersonate other users."]}),"\n",(0,s.jsx)(n.h2,{id:"affected-versions",children:"Affected Versions"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"keystonemiddleware Version"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Status"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:">= 10.5.0, < 10.7.2"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Vulnerable"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:">= 10.8.0, < 10.9.1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Vulnerable"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:">= 10.10.0, < 10.12.1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Vulnerable"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:">= 10.12.1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Fixed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:">= 11.0.0 (Gazpacho)"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Fixed"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["The vulnerable code was introduced in keystonemiddleware 10.5.0 when the ",(0,s.jsx)(n.code,{children:"external_oauth2_token"}),"\nmodule was added."]}),"\n",(0,s.jsx)(n.h2,{id:"impact-on-osism",children:"Impact on OSISM"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"This vulnerability only affects OSISM deployments that use external OAuth 2.0 authorization\nservers for OpenStack authentication."})," Standard OSISM deployments using the default ",(0,s.jsx)(n.code,{children:"auth_token"}),"\nmiddleware with Keystone-native authentication are ",(0,s.jsx)(n.strong,{children:"not affected"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"You are potentially affected if:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Your deployment uses the ",(0,s.jsx)(n.code,{children:"external_oauth2_token"})," middleware instead of the standard ",(0,s.jsx)(n.code,{children:"auth_token"}),"\nmiddleware"]}),"\n",(0,s.jsx)(n.li,{children:"You have configured an external OAuth 2.0 / OpenID Connect (OIDC) identity provider for\nOpenStack authentication"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"how-to-check-if-you-are-affected",children:"How to Check if You Are Affected"}),"\n",(0,s.jsx)(n.h4,{id:"check-in-the-configuration-repository",children:"Check in the Configuration Repository"}),"\n",(0,s.jsxs)(n.p,{children:["In OSISM, custom Keystone paste configurations are managed via overlay files in the configuration\nrepository. The file ",(0,s.jsx)(n.code,{children:"environments/kolla/files/overlays/keystone/keystone-paste.ini"})," is deployed\nto ",(0,s.jsx)(n.code,{children:"/etc/keystone/keystone-paste.ini"})," in the Keystone container (which serves as the\n",(0,s.jsx)(n.code,{children:"api-paste.ini"}),")."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Check if you have a custom paste configuration:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# In your configuration repository\nls -la environments/kolla/files/overlays/keystone/keystone-paste.ini\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If this file exists, check for the ",(0,s.jsx)(n.code,{children:"ext_oauth2_token"})," filter:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'grep "ext_oauth2_token" environments/kolla/files/overlays/keystone/keystone-paste.ini\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the file does not exist or the grep returns no results, your deployment uses the standard\nauthentication and is ",(0,s.jsx)(n.strong,{children:"not affected"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"check-on-the-running-deployment",children:"Check on the Running Deployment"}),"\n",(0,s.jsx)(n.p,{children:"Alternatively, check directly on a control node:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'docker exec keystone grep "ext_oauth2_token" /etc/keystone/keystone-paste.ini\n'})}),"\n",(0,s.jsxs)(n.p,{children:["If no results are returned, your deployment is ",(0,s.jsx)(n.strong,{children:"not affected"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"vulnerability-details",children:"Vulnerability Details"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"external_oauth2_token"})," middleware only conditionally sets certain identity headers (e.g.,\n",(0,s.jsx)(n.code,{children:"X-Is-Admin-Project"})," is only set when the token has admin privileges). This conditional logic\nleaves spoofed header values intact when the expected conditions are not met."]}),"\n",(0,s.jsx)(n.p,{children:"An authenticated attacker could exploit this by injecting forged identity headers such as:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"X-Is-Admin-Project"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"X-Roles"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"X-User-Id"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"X-User-Domain-Id"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This allows privilege escalation to admin roles or impersonation of other users."}),"\n",(0,s.jsx)(n.h2,{id:"remediation",children:"Remediation"}),"\n",(0,s.jsx)(n.h3,{id:"for-osism-releases",children:"For OSISM Releases"}),"\n",(0,s.jsxs)(n.p,{children:["A fix will be included in upcoming OSISM releases that ship a patched keystonemiddleware version.\nConsult the ",(0,s.jsx)(n.a,{href:"../../release-notes/",children:"OSISM Release Notes"})," for version information and availability."]}),"\n",(0,s.jsxs)(n.p,{children:["Alternatively, you can use rolling tags to override the Keystone container image with a version\nthat includes the fix. Configure the following in ",(0,s.jsx)(n.code,{children:"environments/kolla/images.yml"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'keystone_tag: "2024.2"  # or "2025.1", depending on your OpenStack release\n'})}),"\n",(0,s.jsx)(n.h3,{id:"mitigation",children:"Mitigation"}),"\n",(0,s.jsx)(n.p,{children:"If you use external OAuth 2.0 authentication, consider the following measures:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Restricting network access to OpenStack API endpoints"}),"\n",(0,s.jsx)(n.li,{children:"Monitoring for suspicious API requests with unusual identity headers"}),"\n",(0,s.jsx)(n.li,{children:"Temporarily reverting to Keystone-native authentication if feasible"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://security.openstack.org/ossa/OSSA-2026-001.html",children:"OSSA-2026-001 Advisory"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://review.opendev.org/c/openstack/keystonemiddleware/+/973497",children:"OpenDev Review (Fix)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://bugs.launchpad.net/keystonemiddleware/+bug/2129018",children:"Launchpad Bug #2129018"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.cve.org/CVERecord?id=CVE-2026-22797",children:"CVE-2026-22797"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.openwall.com/lists/oss-security/2026/01/16/9",children:"oss-security Announcement"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.openstack.org/keystonemiddleware/latest/middlewarearchitecture.html",children:"Keystonemiddleware Documentation"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>o});var i=t(6540);const s={},l=i.createContext(s);function r(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);