<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-advanced-guides/testbed" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Testbed | OSISM</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-test-site.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-test-site.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/advanced-guides/testbed"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Testbed | OSISM"><meta data-rh="true" name="description" content="ðŸ’¡ With the OSISM Testbed, it is possible to run a full Sovereign Cloud Stack"><meta data-rh="true" property="og:description" content="ðŸ’¡ With the OSISM Testbed, it is possible to run a full Sovereign Cloud Stack"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/advanced-guides/testbed"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/advanced-guides/testbed" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/advanced-guides/testbed" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OSISM RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OSISM Atom Feed"><link rel="stylesheet" href="/assets/css/styles.59fdc8c2.css">
<link rel="preload" href="/assets/js/runtime~main.9339bb09.js" as="script">
<link rel="preload" href="/assets/js/main.b5c48b30.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="OSISM Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="OSISM Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OSISM</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/osism/osism.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/intro/">Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/guides/">Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/advanced-guides/">Advanced Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced-guides/cloud-in-a-box">Cloud in a Box</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/advanced-guides/testbed">Testbed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced-guides/contributor-guide">Contributor Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/advanced-guides/developer-guide/">Developer Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced-guides/style-guide">Style Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/references/">References</a><button aria-label="Toggle the collapsible sidebar category &#x27;References&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/release-notes/">Release Notes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Release Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/appendix/">Appendix</a><button aria-label="Toggle the collapsible sidebar category &#x27;Appendix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/advanced-guides/"><span itemprop="name">Advanced Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Testbed</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Testbed</h1><p>ðŸ’¡ With the OSISM Testbed, it is possible to run a full Sovereign Cloud Stack
deployment on an existing OpenStack environment such as Cleura or REGIO.cloud.</p><p>OSISM is the reference implementation for the infrastructure as a service layer in the
<a href="https://scs.community" target="_blank" rel="noopener noreferrer">Sovereign Cloud Stack</a> (SCS) project. The OSISM Testbed is therefore
used in the SCS project to test and work on the Instrastructure as a Service layer.</p><p>The OSISM Testbed is intended as a playground. Further services and integration will
be added over time. More and more best practices and experiences from the productive
deployments will be included here in the future. It will become more production-like
over time. However, at no point does it claim to represent a production setup exactly.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-access">Cloud access<a href="#cloud-access" class="hash-link" aria-label="Direct link to Cloud access" title="Direct link to Cloud access">â€‹</a></h3><p>The prerequisite is to have an account on one of the supported OpenStack cloud providers.</p><p>It is not part of this guide to describe the registration with the individual cloud
providers. Please contact the respective cloud provider for this.</p><table><thead><tr><th><strong>Product</strong></th><th><strong>Provider</strong></th><th><strong>Profile name</strong></th></tr></thead><tbody><tr><td>Cleura</td><td>Cleura</td><td><code>cleura</code></td></tr><tr><td>Fuga Cloud</td><td>FUGA</td><td><code>fuga</code></td></tr><tr><td>HuaweiCloud</td><td>HuaweiCloud</td><td><code>huaweicloud</code></td></tr><tr><td>OVH</td><td>OVH</td><td><code>ovh</code></td></tr><tr><td>OpenTelekomCloud</td><td>T-Systems</td><td><code>otc</code></td></tr><tr><td>pluscloud open</td><td>plusserver</td><td><code>pluscloudopen</code></td></tr><tr><td>REGIO.cloud</td><td>OSISM</td><td><code>regiocloud</code></td></tr><tr><td>Wavestack</td><td>noris network</td><td><code>wavestack</code></td></tr></tbody></table><p>For each provider listed in the table, a predefined profile is available in the
<code>terraform/environments</code> directory. This profile contains the name of the public
network, which flavors to use, etc.</p><p>Here is an example from the profile for REGIO.cloud.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flavor_manager            = &quot;SCS-4V-8-50&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flavor_node               = &quot;SCS-8V-32-100&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volume_type               = &quot;ssd&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image                     = &quot;Ubuntu 22.04&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">image_node                = &quot;Ubuntu 22.04&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public                    = &quot;public&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">availability_zone         = &quot;nova&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">volume_availability_zone  = &quot;nova&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">network_availability_zone = &quot;nova&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-resources">Cloud resources<a href="#cloud-resources" class="hash-link" aria-label="Direct link to Cloud resources" title="Direct link to Cloud resources">â€‹</a></h3><p>The OSISM Testbed requires at least the following project quota when using the default flavors:</p><table><thead><tr><th><strong>Resource</strong></th><th><strong>Quantity</strong></th><th><strong>Note</strong></th></tr></thead><tbody><tr><td>4</td><td>Instances</td><td>28 VCPUs + 104 GByte RAM</td></tr><tr><td>9</td><td>Volumes</td><td>90 GByte volume storage</td></tr><tr><td>1</td><td>Floating IP</td><td></td></tr><tr><td>1</td><td>Keypair</td><td></td></tr><tr><td>3</td><td>Security group</td><td></td></tr><tr><td>16</td><td>Security group rules</td><td></td></tr><tr><td>1</td><td>Network</td><td></td></tr><tr><td>1</td><td>Subetwork</td><td></td></tr><tr><td>6</td><td>Ports</td><td></td></tr><tr><td>1</td><td>Router</td><td></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparations">Preparations<a href="#preparations" class="hash-link" aria-label="Direct link to Preparations" title="Direct link to Preparations">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="software">Software<a href="#software" class="hash-link" aria-label="Direct link to Software" title="Direct link to Software">â€‹</a></h3><ul><li><code>make</code> must be installed on the system</li><li><code>yq</code> must be installed on the system. <a href="https://github.com/mikefarah/yq" target="_blank" rel="noopener noreferrer">yq</a> is a portable
command-line YAML, JSON, XML, CSV, TOML and properties processor.</li><li>Ansible in a current version must be installed and usable on the local workstation. Currently Ansible 8 is supported.
Information on installing Ansible can be found in the <a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html" target="_blank" rel="noopener noreferrer">Ansible
documentation</a></li><li>Terraform in a current version must be installed and usable on the local workstation. Currently Terraform 1.5 is supported.
Information on installing Terraform can be found in the <a href="https://learn.hashicorp.com/tutorials/terraform/install-cli" target="_blank" rel="noopener noreferrer">Terraform
documentation</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="custom-ca">Custom CA<a href="#custom-ca" class="hash-link" aria-label="Direct link to Custom CA" title="Direct link to Custom CA">â€‹</a></h3><p>The OSISM Testbed installation currently uses hostnames in the domain <code>testbed.osism.xyz</code>.  This is a real domain
and we provide the DNS records matching the addresses used in the OSISM Testbed, so that once you connect to your testbed via a direct
link or Wireguard, you can access hosts and servers by their hostname (e.g. <code>ssh testbed-manager.testbed.osism.xyz</code>).</p><p>We also provide a wildcard TLS certificate signed by a custom CA for <code>testbed.osism.xyz</code> and <code>*.testbed.osism.xyz</code>.</p><p>This CA is always used for each testbed. The CA is not regenerated and it is not planned to change this for the next 10 years.</p><p>In order for these certificates to be recognized locally as valid, the CA
<a href="https://raw.githubusercontent.com/osism/testbed/main/environments/kolla/certificates/ca/testbed.crt" target="_blank" rel="noopener noreferrer">environments/kolla/certificates/ca/testbed.crt</a>
must be imported locally.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="getting-started">Getting Started<a href="#getting-started" class="hash-link" aria-label="Direct link to Getting Started" title="Direct link to Getting Started">â€‹</a></h2><p>This section describes step by step how to deploy the OSISM Testbed.</p><ol><li><p>Clone the <a href="https://github.com/osism/testbed" target="_blank" rel="noopener noreferrer">osism/testbed</a> repository.
The repository can also be cloned to any other location.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ~/src/github.com/osism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/osism/testbed ~/src/github.com/osism/testbed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ~/src/github.com/osism/testbed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><ol start="2"><li><p>The access data for the cloud provider used is then stored in <code>terraform/clouds.yaml</code>.
The <code>clouds.yaml</code> file is provided by the cloud provider used. Please check the documentation
of the cloud provider you are using or their support for details.</p><p>REGIO.cloud is used as an example. The cloud name in <code>clouds.yaml</code>
and the environment name (value of <code>ENVIRONMENT</code>) are <code>regiocloud</code> in this case. If another cloud
is used, replace <code>regioclodu</code> with the respective profile name from the table above.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">clouds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">regiocloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">auth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">auth_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//keystone.services.a.regiocloud.tech/v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">project_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PROJECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">username</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> USERNAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PASSWORD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">project_domain_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DOMAIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">user_domain_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DOMAIN</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The use of application credentials is preferred. This way it is not necessary to store
details like username or project name or sensitive information like the password in the
<code>clouds.yaml</code> file.</p><p>The application credentials can be found in Horizon under <strong>Identity</strong>. Use <code>OSISM testbed</code> as
name and click <code>Create Application Credential</code>.</p><p>The <code>clouds.yaml</code> file of REGIO.cloud can be used as an example for the use of
application credentials. With another cloud provider, only the <code>auth_url</code> must then be changed
accordingly.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">clouds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">regiocloud</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">auth</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">auth_url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//keystone.services.a.regiocloud.tech/v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">application_credential_id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">application_credential_secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SECRET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">auth_type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;v3applicationcredential&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Prepare the deployment. The versions of Ansible and Terraform are checked and necessary
dependencies are cloned.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make prepare</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Create the infrastructure with Terraform.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make ENVIRONMENT=regiocloud create</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Deploy the OSISM manager and bootstrap all nodes.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make ENVIRONMENT=regiocloud manager</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Deploy all services. Depending on the cloud, the installation will take some time. Up
to two hours is not unusual. In this step, Ceph, OpenStack and all necessary
infrastructure services (MariaDB, RabbitMQ, ...) are deployed.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make ENVIRONMENT=regiocloud deploy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Alternatively, it is also possible to deploy the services step by step directly on the
manager. To do this, first log in to the manager with <code>make ENVIRONMENT=regiocloud login</code>
and then execute the deploy scripts one after the other. It is recommended to do this
within a screen session.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/opt/configuration/scripts/deploy/001-helper-services.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/configuration/scripts/deploy/100-ceph-services-basic.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/configuration/scripts/deploy/200-infrastructure-services-basic.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/configuration/scripts/deploy/300-openstack-services-basic.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/configuration/scripts/deploy/400-monitoring-services.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Deploying the services takes some time and depends on how much bandwidth is available,
how the instances are equipped, etc. 90-120 minutes is not unusual when Ceph and OpenStack
are fully deployed.</p></li><li><p>After the deployment, you can log in to the manager via SSH.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make ENVIRONMENT=regiocloud login</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>If you want you can create a test project with a test user after login. It also
creates an instance with a volume attached to a network with a router.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">osism apply --environment openstack test</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>When the OSISM Testbed is no longer needed, it can be deleted.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make ENVIRONMENT=regiocloud clean</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">â€‹</a></h2><p>This section describes how to configure and customise the OSISM Testbed.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="variables">Variables<a href="#variables" class="hash-link" aria-label="Direct link to Variables" title="Direct link to Variables">â€‹</a></h3><p>The defaults for the Terraform variables are intended for REGIO.cloud.</p><table><thead><tr><th><strong>Variable</strong></th><th><strong>Default</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td>availability_zone</td><td><code>nova</code></td><td></td></tr><tr><td>ceph_version</td><td><code>quincy</code></td><td></td></tr><tr><td>cloud_provider</td><td><code>regiocloud</code></td><td></td></tr><tr><td>configuration_version</td><td><code>main</code></td><td></td></tr><tr><td>deploy_monitoring</td><td><code>false</code></td><td></td></tr><tr><td>dns_nameservers</td><td><code>[&quot;8.8.8.8&quot;, &quot;9.9.9.9&quot;]</code></td><td></td></tr><tr><td>enable_config_drive</td><td><code>true</code></td><td></td></tr><tr><td>flavor_manager</td><td><code>SCS-4V-8-50</code></td><td></td></tr><tr><td>flavor_node</td><td><code>SCS-8V-32-50</code></td><td></td></tr><tr><td>image</td><td><code>Ubuntu 22.04</code></td><td></td></tr><tr><td>manager_version</td><td><code>latest</code></td><td></td></tr><tr><td>network_availability_zone</td><td><code>nova</code></td><td></td></tr><tr><td>number_of_nodes</td><td><code>3</code></td><td></td></tr><tr><td>number_of_volumes</td><td><code>3</code></td><td></td></tr><tr><td>openstack_version</td><td><code>2023.1</code></td><td></td></tr><tr><td>prefix</td><td><code>testbed</code></td><td></td></tr><tr><td>public</td><td><code>external</code></td><td></td></tr><tr><td>refstack</td><td><code>false</code></td><td></td></tr><tr><td>volume_availability_zone</td><td><code>nova</code></td><td></td></tr><tr><td>volume_size_base</td><td><code>30</code></td><td></td></tr><tr><td>volume_size_storage</td><td><code>10</code></td><td></td></tr><tr><td>volume_type</td><td><code>__DEFAULT__</code></td><td></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overrides">Overrides<a href="#overrides" class="hash-link" aria-label="Direct link to Overrides" title="Direct link to Overrides">â€‹</a></h3><table><thead><tr><th><strong>Name</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><code>manager_boot_from_image</code></td><td></td></tr><tr><td><code>manager_boot_from_volume</code></td><td></td></tr><tr><td><code>neutron_availability_zone_hints_network</code></td><td></td></tr><tr><td><code>neutron_availability_zone_hints_router</code></td><td></td></tr><tr><td><code>neutron_router_enable_snat</code></td><td></td></tr><tr><td><code>nodes_boot_from_image</code></td><td></td></tr><tr><td><code>nodes_boot_from_volume</code></td><td></td></tr><tr><td><code>nodes_use_ephemeral_storage</code></td><td></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="customisations">Customisations<a href="#customisations" class="hash-link" aria-label="Direct link to Customisations" title="Direct link to Customisations">â€‹</a></h3><table><thead><tr><th><strong>Name</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><code>access_floatingip</code></td><td></td></tr><tr><td><code>access_ipv4</code></td><td></td></tr><tr><td><code>access_ipv6</code></td><td></td></tr><tr><td><code>default</code></td><td></td></tr><tr><td><code>neutron_floatingip</code></td><td></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vpn-access">VPN access<a href="#vpn-access" class="hash-link" aria-label="Direct link to VPN access" title="Direct link to VPN access">â€‹</a></h3><p>Copy the <code>/home/dragon/wireguard-client.conf</code> file to your workstation. This is necessary
for using the web endpoints on your workstation. Rename the wireguard config file to something
like <code>testbed.conf</code>.</p><p>If you want to connect to the OSISM Testbed from multiple clients, change the client IP
address in the config file to be different on each client.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">scp</span><span class="token plain"> dragon@IP_FROM_YOUR_SERVER:/home/dragon/wireguard-client.conf /home/ubuntu/testbed.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Install wireguard on your workstation, if you have not done this before. For instructions how to do
it on your workstation, please have a look on the documentation of your used distribution. The
wireguard documentation you will find <a href="https://www.wireguard.com/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Start the wireguard tunnel.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wg-quick up /home/ubuntu/testbed.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you do not want to use Wireguard you can also work with <a href="https://github.com/sshuttle/sshuttle" target="_blank" rel="noopener noreferrer">sshuttle</a>.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make sshuttle ENVIRONMENT=regiocloud</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="webinterfaces">Webinterfaces<a href="#webinterfaces" class="hash-link" aria-label="Direct link to Webinterfaces" title="Direct link to Webinterfaces">â€‹</a></h3><p>All SSL enabled services within the OSISM Testbed use certs which are signed by the self-signed
<a href="https://raw.githubusercontent.com/osism/testbed/main/environments/kolla/certificates/ca/testbed.crt" target="_blank" rel="noopener noreferrer">OSISM Testbed CA</a>.</p><p>If you want to access the services please choose the URL from the following table.</p><table><thead><tr><th><strong>Name</strong></th><th><strong>URL</strong></th><th><strong>Username</strong></th><th><strong>Password</strong></th><th><strong>Note</strong></th></tr></thead><tbody><tr><td>ARA</td><td><a href="https://ara.testbed.osism.xyz/" target="_blank" rel="noopener noreferrer">https://ara.testbed.osism.xyz/</a></td><td>ara</td><td>password</td><td></td></tr><tr><td>Ceph</td><td><a href="https://api-int.testbed.osism.xyz:8140" target="_blank" rel="noopener noreferrer">https://api-int.testbed.osism.xyz:8140</a></td><td>admin</td><td>password</td><td></td></tr><tr><td>Flower</td><td><a href="https://api-int.testbed.osism.xyz:8140" target="_blank" rel="noopener noreferrer">https://api-int.testbed.osism.xyz:8140</a></td><td></td><td></td><td></td></tr><tr><td>Grafana</td><td><a href="https://api-int.testbed.osism.xyz:3000" target="_blank" rel="noopener noreferrer">https://api-int.testbed.osism.xyz:3000</a></td><td>admin</td><td>password</td><td></td></tr><tr><td>Homer</td><td><a href="https://homer.testbed.osism.xyz" target="_blank" rel="noopener noreferrer">https://homer.testbed.osism.xyz</a></td><td></td><td></td><td></td></tr><tr><td>Horizon (via Keystone)</td><td><a href="https://api.testbed.osism.xyz" target="_blank" rel="noopener noreferrer">https://api.testbed.osism.xyz</a></td><td>admin</td><td>password</td><td>domain: default</td></tr><tr><td>Horizon (via Keystone)</td><td><a href="https://api.testbed.osism.xyz" target="_blank" rel="noopener noreferrer">https://api.testbed.osism.xyz</a></td><td>test</td><td>test</td><td>domain: test</td></tr><tr><td>Horizon (via Keycloak)</td><td><a href="https://api.testbed.osism.xyz" target="_blank" rel="noopener noreferrer">https://api.testbed.osism.xyz</a></td><td>alice</td><td>password</td><td></td></tr><tr><td>Keycloak</td><td><a href="https://keycloak.testbed.osism.xyz" target="_blank" rel="noopener noreferrer">https://keycloak.testbed.osism.xyz</a></td><td>admin</td><td>password</td><td></td></tr><tr><td>Kibana</td><td><a href="https://api.testbed.osism.xyz:5601" target="_blank" rel="noopener noreferrer">https://api.testbed.osism.xyz:5601</a></td><td>kibana</td><td>password</td><td></td></tr><tr><td>Netbox</td><td><a href="https://netbox.testbed.osism.xyz/" target="_blank" rel="noopener noreferrer">https://netbox.testbed.osism.xyz/</a></td><td>admin</td><td>password</td><td></td></tr><tr><td>Netdata</td><td><a href="https://testbed-manager.testbed.osism.xyz:19999" target="_blank" rel="noopener noreferrer">https://testbed-manager.testbed.osism.xyz:19999</a></td><td></td><td></td><td></td></tr><tr><td>Patchman</td><td><a href="https://patchman.testbed.osism.xyz/" target="_blank" rel="noopener noreferrer">https://patchman.testbed.osism.xyz/</a></td><td>patchman</td><td>password</td><td></td></tr><tr><td>Prometheus</td><td><a href="https://api-int.testbed.osism.xyz:9091/" target="_blank" rel="noopener noreferrer">https://api-int.testbed.osism.xyz:9091/</a></td><td></td><td></td><td></td></tr><tr><td>phpMyAdmin</td><td><a href="https://phpmyadmin.testbed.osism.xyz" target="_blank" rel="noopener noreferrer">https://phpmyadmin.testbed.osism.xyz</a></td><td>root</td><td>password</td><td></td></tr><tr><td>RabbitMQ</td><td><a href="https://api-int.testbed.osism.xyz:15672/" target="_blank" rel="noopener noreferrer">https://api-int.testbed.osism.xyz:15672/</a></td><td>openstack</td><td>BO6yGAAq9eqA7IKqeBdtAEO7aJuNu4zfbhtnRo8Y</td><td></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-with-oidc">Authentication with OIDC<a href="#authentication-with-oidc" class="hash-link" aria-label="Direct link to Authentication with OIDC" title="Direct link to Authentication with OIDC">â€‹</a></h3><p>Authentication with OpenID Connect (OIDC) is possible via Keycloak, which is automatically configured for the OIDC mechanism.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="openstack-web-dashboard-horizon-login-via-oidc">OpenStack web dashboard (Horizon) login via OIDC<a href="#openstack-web-dashboard-horizon-login-via-oidc" class="hash-link" aria-label="Direct link to OpenStack web dashboard (Horizon) login via OIDC" title="Direct link to OpenStack web dashboard (Horizon) login via OIDC">â€‹</a></h4><p>For logging in via OIDC, open your browser at OpenStack Dashboard Login Page, select <strong>Authenticate via Keycloak</strong>, after being
redirected to the Keycloak login page, perform the login with the credentials <strong>alice</strong> and <strong>password</strong>.
After that you will be redirected back to the Horizon dashboard, where you will be logged in with the user <strong>alice</strong>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="openstack-web-dashboard-horizon-logout">OpenStack web dashboard (Horizon) logout<a href="#openstack-web-dashboard-horizon-logout" class="hash-link" aria-label="Direct link to OpenStack web dashboard (Horizon) logout" title="Direct link to OpenStack web dashboard (Horizon) logout">â€‹</a></h4><p>Keep in mind, that clicking <strong>Sign Out</strong> on the Horizon dashboard currently doesn&#x27;t revoke your OIDC token, and any consequent
attempt to <strong>Authenticate via Keycloak</strong> will succeed without providing the credentials.</p><p>The expiration time of the Single Sign On tokens can be controlled on multiple levels in Keycloak.</p><ol><li><p>On realm level under <em>Realm Settings</em> &gt; <em>Tokens</em>.
Assuming the <em>keycloak_realm</em> ansible variable is the default <em>osism</em>, and keycloak is listening on
<a href="https://keycloak.testbed.osism.xyz" target="_blank" rel="noopener noreferrer">https://keycloak.testbed.osism.xyz</a>, then the configuration form is available here:
<a href="https://keycloak.testbed.osism.xyz/auth/admin/master/console/#/realms/osism/token-settings" target="_blank" rel="noopener noreferrer">https://keycloak.testbed.osism.xyz/auth/admin/master/console/#/realms/osism/token-settings</a></p><p>Detailed information is available in the Keycloak Server Administrator Documentation
<a href="https://www.keycloak.org/docs/latest/server_admin/#_timeouts" target="_blank" rel="noopener noreferrer">Session and Token Timeouts</a> section.</p></li><li><p>In a realm down on the <a href="https://keycloak.testbed.osism.xyz/auth/admin/master/console/#/realms/osism/clients" target="_blank" rel="noopener noreferrer">client level</a>
select the client (keystone), and under <em>Settings</em> &gt; <em>Advanced Settings</em>.</p><p>It is recommended to keep the <em>Access Token Lifespan</em> on a relatively low value, with the trend of blocking third party
cookies. For further information see the Keycloak documentation&#x27;s <a href="https://www.keycloak.org/docs/latest/securing_apps/#browsers-with-blocked-third-party-cookies" target="_blank" rel="noopener noreferrer">Browsers with Blocked Third-Party Cookies</a> section.</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="openstack-cli-operations-with-openid-connect-password">OpenStack CLI operations with OpenID Connect password<a href="#openstack-cli-operations-with-openid-connect-password" class="hash-link" aria-label="Direct link to OpenStack CLI operations with OpenID Connect password" title="Direct link to OpenStack CLI operations with OpenID Connect password">â€‹</a></h4><p>Using the OpenStack cli is also possible via OIDC, assuming you provisioned the user <strong>alice</strong> with password <strong>password</strong>,
then you can perform a simple <code>project list</code> operation like this:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-cacert /etc/ssl/certs/ca-certificates.crt \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-auth-url https://api.testbed.osism.xyz:5000/v3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-auth-type v3oidcpassword \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-client-id keystone \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-client-secret 0056b89c-030f-486b-a6ad-f0fa398fa4ad \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-username alice \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-password password \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-identity-provider keycloak \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-protocol openid \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-identity-api-version 3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-discovery-endpoint https://keycloak.testbed.osism.xyz/auth/realms/osism/.well-known/openid-configuration \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">project list</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="openstack-cli-token-issue-with-openid-connect">OpenStack CLI token issue with OpenID Connect<a href="#openstack-cli-token-issue-with-openid-connect" class="hash-link" aria-label="Direct link to OpenStack CLI token issue with OpenID Connect" title="Direct link to OpenStack CLI token issue with OpenID Connect">â€‹</a></h4><p>It is also possible to exchange your username/password to a token, for further use with the cli.
The <code>token issue</code> subcommand returns an SQL table, in which the <code>id</code> column&#x27;s <code>value</code> field contains the token:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openstack \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-cacert /etc/ssl/certs/ca-certificates.crt \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-auth-url https://api.testbed.osism.xyz:5000/v3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-auth-type v3oidcpassword \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-client-id keystone \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-client-secret 0056b89c-030f-486b-a6ad-f0fa398fa4ad \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-username alice \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-password password \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-identity-provider keycloak \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-protocol openid \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-identity-api-version 3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-discovery-endpoint https://keycloak.testbed.osism.xyz/auth/realms/osism/.well-known/openid-configuration \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> --os-openid-scope &quot;openid profile email&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">token issue \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -c id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -f value</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An example token is like:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gAAAAABhC98gL8nsQWknro3JWDXWLFCG3CDr3Mi9OIlvVAZMjy2mNgYtlXv_0yAIy-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nSlLAaLIGhht17-mwf8uclKgRuNVsYLSmgUpB163l89-ch2w2_OFe9zNSQNWf4qfd8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cl7E7XvvUoFr1N8Gh09vaYLvRvYgCGV05xBUSs76qCHa0qElPUsk56s5ft4ALrSrzD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4cEQRVb5PXNjywdZk9_gtJziz31A7sD4LPIy82O5N9NryDoDw</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>TODO: OpenStack CLI operations with token</li><li>TODO: OpenStack CLI token revoke</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-usage">Advanced Usage<a href="#advanced-usage" class="hash-link" aria-label="Direct link to Advanced Usage" title="Direct link to Advanced Usage">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="change-versions">Change versions<a href="#change-versions" class="hash-link" aria-label="Direct link to Change versions" title="Direct link to Change versions">â€‹</a></h3><ol><li>Go to <code>/opt/configuration</code> on <code>testbed-manager</code></li><li>Run <code>./scripts/set-openstack-version.sh zed</code> to set the OpenStack version to <code>zed</code></li><li>Run <code>./scripts/set-ceph-version.sh quincy</code> to set the Ceph version to <code>quincy</code></li><li>Run <code>osism-update-manager</code> to update the manager</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-services">Deploy services<a href="#deploy-services" class="hash-link" aria-label="Direct link to Deploy services" title="Direct link to Deploy services">â€‹</a></h3><table><thead><tr><th>Script</th><th>Description</th></tr></thead><tbody><tr><td><code>/opt/configuration/scripts/deploy/000-manager-service.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/001-helper-services.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/100-ceph-services-basic.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/200-infrastructure-services-basic.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/210-infrastructure-services-extended.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/300-openstack-services-basic.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/310-openstack-services-extended.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/320-openstack-services-baremetal.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/330-openstack-services-additional.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/deploy/400-monitoring-services.sh</code></td><td></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-services">Upgrade services<a href="#upgrade-services" class="hash-link" aria-label="Direct link to Upgrade services" title="Direct link to Upgrade services">â€‹</a></h3><table><thead><tr><th>Script</th><th>Description</th></tr></thead><tbody><tr><td><code>/opt/configuration/scripts/upgrade/100-ceph-services.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/upgrade/200-infrastructure-services-basic.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/upgrade/300-openstack-services-basic.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/upgrade/310-openstack-services-extended.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/upgrade/320-openstack-services-baremetal.sh</code></td><td></td></tr><tr><td><code>/opt/configuration/scripts/upgrade/330-openstack-services-additional.sh</code></td><td></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unsupported-locale-setting">Unsupported locale setting<a href="#unsupported-locale-setting" class="hash-link" aria-label="Direct link to Unsupported locale setting" title="Direct link to Unsupported locale setting">â€‹</a></h3><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ make prepare</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ansible-playbook -i localhost, ansible/check-local-versions.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR: Ansible could not initialize the preferred locale: unsupported locale setting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make: *** [prepare] Error 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To solve the problem you have to modify the <code>Makefile</code>. Change the 1st line as follows.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export LC_ALL = en_US.UTF-8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To find out the locale used on the system <code>printenv</code> can be used.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ printenv | grep -i lang|locale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LANG=&quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LC_COLLATE=&quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LC_CTYPE=&quot;UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LC_MESSAGES=&quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LC_MONETARY=&quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LC_NUMERIC=&quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LC_TIME=&quot;en_US.UTF-8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LC_ALL=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="yq-no-such-file-or-directory">yq: No such file or directory<a href="#yq-no-such-file-or-directory" class="hash-link" aria-label="Direct link to yq: No such file or directory" title="Direct link to yq: No such file or directory">â€‹</a></h3><p>The following error occurs when yq is not installed.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make: yq: No such file or directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>yq</code> must be installed on the system. <a href="https://github.com/mikefarah/yq" target="_blank" rel="noopener noreferrer">yq</a> is a portable
command-line YAML, JSON, XML, CSV, TOML and properties processor.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="notes">Notes<a href="#notes" class="hash-link" aria-label="Direct link to Notes" title="Direct link to Notes">â€‹</a></h2><ul><li>The configuration is intentionally kept quite static. Please create no PRs to make the configuration more flexible/dynamic.</li><li>The OSISM documentation uses hostnames, examples, addresses etc. from OSISM Testbed.</li><li>Even if all components (storage, network, compute, control) are operated on the same nodes, there are separate networks.
This is because in larger productive HCI environments, dedicated control nodes and network nodes are usually provided.
It is also common to place storage frontend and storage backend on an independent/additional network infrastructure.</li><li>The third volume (<code>/dev/sdd</code>) is not enabled for Ceph by default. This is to test the scaling of Ceph.</li><li>Ansible errors that have something to do with undefined variables (e.g. <code>AnsibleUndefined</code>) are most likely due to cached
facts that are no longer valid. The facts can be updated by running <code>osism apply facts</code>.</li><li>The manager is used as pull through cache for Docker images and Ubuntu packages. This reduces the amount of traffic consumed.</li><li>To speed up the Ansible playbooks, <a href="https://ara.recordsansible.org" target="_blank" rel="noopener noreferrer">ARA</a> can be disabled. This
is done by executing <code>/opt/configuration/scripts/disable-ara.sh</code>. Afterwards no more logs are available in the ARA web
interface.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a href="#appendix" class="hash-link" aria-label="Direct link to Appendix" title="Direct link to Appendix">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="supported-releases">Supported releases<a href="#supported-releases" class="hash-link" aria-label="Direct link to Supported releases" title="Direct link to Supported releases">â€‹</a></h3><p>The following stable Ceph and OpenStack releases are supported.</p><p>The deployment of Ceph is based on <a href="https://docs.ceph.com/ceph-ansible/" target="_blank" rel="noopener noreferrer">ceph-ansible</a>.</p><ul><li>Ceph Pacific</li><li>Ceph Quincy (<strong>default</strong>)</li></ul><p>The deployment of OpenStack is based on <a href="https://docs.openstack.org/kolla-ansible/latest/" target="_blank" rel="noopener noreferrer">kolla-ansible</a>.</p><ul><li>OpenStack Zed</li><li>OpenStack 2023.1 (<strong>default</strong>)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="included-services">Included services<a href="#included-services" class="hash-link" aria-label="Direct link to Included services" title="Direct link to Included services">â€‹</a></h3><p>The following services can currently be used with this testbed without further adjustments.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure">Infrastructure<a href="#infrastructure" class="hash-link" aria-label="Direct link to Infrastructure" title="Direct link to Infrastructure">â€‹</a></h4><ul><li>Ceph</li><li>Fluentd</li><li>Gnocchi</li><li>Grafana</li><li>Haproxy</li><li>Influxdb</li><li>Keepalived</li><li>Keycloak</li><li>Kubernetes CAPI Management Cluster</li><li>Mariadb</li><li>Memcached</li><li>Netbox</li><li>Netdata</li><li>Opensearch</li><li>Openvswitch</li><li>Patchman</li><li>Prometheus exporters</li><li>Rabbitmq</li><li>Redis</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="openstack">OpenStack<a href="#openstack" class="hash-link" aria-label="Direct link to OpenStack" title="Direct link to OpenStack">â€‹</a></h4><ul><li>Barbican</li><li>Ceilometer</li><li>Cinder</li><li>Designate</li><li>Glance</li><li>Heat</li><li>Horizon</li><li>Ironic</li><li>Keystone</li><li>Magnum</li><li>Manila</li><li>Neutron</li><li>Nova (with Libvirt/KVM)</li><li>Octavia</li><li>Senlin</li><li>Skyline</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="makfile-reference">Makfile reference<a href="#makfile-reference" class="hash-link" aria-label="Direct link to Makfile reference" title="Direct link to Makfile reference">â€‹</a></h3><table><thead><tr><th><strong>Target</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td>clean</td><td>Destroy infrastructure with Terraform.</td></tr><tr><td>create</td><td>Create required infrastructure with Terraform.</td></tr><tr><td>login</td><td>Log in on the manager.</td></tr><tr><td>bootstrap</td><td>Bootstrap everything.</td></tr><tr><td>manager</td><td>Deploy only the manager service.</td></tr><tr><td>identity</td><td>Deploy only identity services.</td></tr><tr><td>ceph</td><td>Deploy only ceph services.</td></tr><tr><td>deploy</td><td>Deploy everything and then check it.</td></tr><tr><td>prepare</td><td>Run local preparations.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ci-jobs">CI jobs<a href="#ci-jobs" class="hash-link" aria-label="Direct link to CI jobs" title="Direct link to CI jobs">â€‹</a></h3><table><thead><tr><th><strong>Name</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td>testbed-deploy</td><td></td></tr><tr><td>testbed-deploy-ceph</td><td></td></tr><tr><td>testbed-deploy-cleura</td><td></td></tr><tr><td>testbed-deploy-pco</td><td></td></tr><tr><td>testbed-deploy-stable</td><td></td></tr><tr><td>testbed-deploy-wavestack</td><td></td></tr><tr><td>testbed-update-stable</td><td></td></tr><tr><td>testbed-upgrade</td><td></td></tr><tr><td>testbed-upgrade-ceph</td><td></td></tr><tr><td>testbed-upgrade-cleura</td><td></td></tr><tr><td>testbed-upgrade-pco</td><td></td></tr><tr><td>testbed-upgrade-stable</td><td></td></tr><tr><td>testbed-upgrade-wavestack</td><td></td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/osism/osism.github.io/tree/main/docs/advanced-guides/testbed.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/advanced-guides/cloud-in-a-box"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cloud in a Box</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/advanced-guides/contributor-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contributor Guide</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a><ul><li><a href="#cloud-access" class="table-of-contents__link toc-highlight">Cloud access</a></li><li><a href="#cloud-resources" class="table-of-contents__link toc-highlight">Cloud resources</a></li></ul></li><li><a href="#preparations" class="table-of-contents__link toc-highlight">Preparations</a><ul><li><a href="#software" class="table-of-contents__link toc-highlight">Software</a></li><li><a href="#custom-ca" class="table-of-contents__link toc-highlight">Custom CA</a></li></ul></li><li><a href="#getting-started" class="table-of-contents__link toc-highlight">Getting Started</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a><ul><li><a href="#variables" class="table-of-contents__link toc-highlight">Variables</a></li><li><a href="#overrides" class="table-of-contents__link toc-highlight">Overrides</a></li><li><a href="#customisations" class="table-of-contents__link toc-highlight">Customisations</a></li></ul></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#vpn-access" class="table-of-contents__link toc-highlight">VPN access</a></li><li><a href="#webinterfaces" class="table-of-contents__link toc-highlight">Webinterfaces</a></li><li><a href="#authentication-with-oidc" class="table-of-contents__link toc-highlight">Authentication with OIDC</a></li></ul></li><li><a href="#advanced-usage" class="table-of-contents__link toc-highlight">Advanced Usage</a><ul><li><a href="#change-versions" class="table-of-contents__link toc-highlight">Change versions</a></li><li><a href="#deploy-services" class="table-of-contents__link toc-highlight">Deploy services</a></li><li><a href="#upgrade-services" class="table-of-contents__link toc-highlight">Upgrade services</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#unsupported-locale-setting" class="table-of-contents__link toc-highlight">Unsupported locale setting</a></li><li><a href="#yq-no-such-file-or-directory" class="table-of-contents__link toc-highlight">yq: No such file or directory</a></li></ul></li><li><a href="#notes" class="table-of-contents__link toc-highlight">Notes</a></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#supported-releases" class="table-of-contents__link toc-highlight">Supported releases</a></li><li><a href="#included-services" class="table-of-contents__link toc-highlight">Included services</a></li><li><a href="#makfile-reference" class="table-of-contents__link toc-highlight">Makfile reference</a></li><li><a href="#ci-jobs" class="table-of-contents__link toc-highlight">CI jobs</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/osism" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 OSISM GmbH. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9339bb09.js"></script>
<script src="/assets/js/main.b5c48b30.js"></script>
</body>
</html>