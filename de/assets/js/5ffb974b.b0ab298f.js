"use strict";(self.webpackChunkosism=self.webpackChunkosism||[]).push([[4088],{9189:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"testbed","title":"Testbed","description":"With the OSISM Testbed, it is possible to run a full Sovereign Cloud Stack","source":"@site/docs/testbed.mdx","sourceDirName":".","slug":"/testbed","permalink":"/de/docs/testbed","draft":false,"unlisted":false,"editUrl":"https://github.com/osism/osism.github.io/tree/main/docs/testbed.mdx","tags":[],"version":"current","sidebarPosition":80,"frontMatter":{"sidebar_label":"Testbed","sidebar_position":80},"sidebar":"tutorialSidebar","previous":{"title":"Running on a virtual machine","permalink":"/de/docs/cloud-in-a-box/running-on-a-virtual-machine"},"next":{"title":"References","permalink":"/de/docs/references/"}}');var l=s(4848),i=s(8453),r=s(5537),d=s(9329);const o={sidebar_label:"Testbed",sidebar_position:80},c="Testbed",a={},h=[{value:"Requirements",id:"requirements",level:2},{value:"Cloud access",id:"cloud-access",level:3},{value:"Cloud resources",id:"cloud-resources",level:3},{value:"Software",id:"software",level:3},{value:"Deployment",id:"deployment",level:2},{value:"Usage",id:"usage",level:2},{value:"Custom CA",id:"custom-ca",level:3},{value:"VPN access",id:"vpn-access",level:3},{value:"Wireguard",id:"wireguard",level:4},{value:"sshuttle",id:"sshuttle",level:4},{value:"Static entries in <code>/etc/hosts</code>",id:"static-entries-in-etchosts",level:3},{value:"Webinterfaces",id:"webinterfaces",level:3},{value:"Usage of the OpenStack CLI",id:"usage-of-the-openstack-cli",level:4},{value:"Advanced Usage",id:"advanced-usage",level:2},{value:"External API",id:"external-api",level:3},{value:"Change versions",id:"change-versions",level:3},{value:"Deploy services",id:"deploy-services",level:3},{value:"Upgrade services",id:"upgrade-services",level:3},{value:"Add new OSD in Ceph",id:"add-new-osd-in-ceph",level:3},{value:"Ceph via Rook (technical preview)",id:"ceph-via-rook-technical-preview",level:3},{value:"Using testbed for OpenStack development",id:"using-testbed-for-openstack-development",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Ansible errors",id:"ansible-errors",level:3},{value:"Unsupported locale setting",id:"unsupported-locale-setting",level:3},{value:"Appendix",id:"appendix",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Variables",id:"variables",level:4},{value:"Overrides",id:"overrides",level:4},{value:"Customisations",id:"customisations",level:4},{value:"Notes",id:"notes",level:3},{value:"Supported releases",id:"supported-releases",level:3},{value:"Included services",id:"included-services",level:3},{value:"Infrastructure",id:"infrastructure",level:4},{value:"OpenStack",id:"openstack",level:4},{value:"Makefile reference",id:"makefile-reference",level:3},{value:"CI jobs",id:"ci-jobs",level:3}];function x(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.header,{children:(0,l.jsx)(t.h1,{id:"testbed",children:"Testbed"})}),"\n",(0,l.jsxs)(t.p,{children:["With the OSISM Testbed, it is possible to run a full Sovereign Cloud Stack\ndeployment on an existing OpenStack environment such as Cleura or ",(0,l.jsx)(t.a,{href:"https://regio.digital",children:"REGIO.cloud"}),"."]}),"\n",(0,l.jsxs)(t.p,{children:["OSISM is the reference implementation for the Infrastructure as a Service (IaaS) layer in the\n",(0,l.jsx)(t.a,{href:"https://www.sovereigncloudstack.org",children:"Sovereign Cloud Stack"})," (SCS) project. The OSISM Testbed is therefore\nused in the SCS project to test and work on the Instrastructure as a Service layer."]}),"\n",(0,l.jsx)(t.p,{children:"The OSISM Testbed is intended as a playground. Further services and integration will\nbe added over time. A increasing number of best practices and experiences from the productive\ndeployments will be included here in the future. It will become more production-like\nover time. However, at no point does it claim to represent a production setup exactly."}),"\n",(0,l.jsx)(t.h2,{id:"requirements",children:"Requirements"}),"\n",(0,l.jsx)(t.h3,{id:"cloud-access",children:"Cloud access"}),"\n",(0,l.jsx)(t.p,{children:"The usual prerequisite is to have an account on one of the supported OpenStack cloud providers.\nAs the OSISM Testbed also virtualizes systems itself, the OpenStack cluster should provide\nthe capabilities for nested virtualization."}),"\n",(0,l.jsx)(t.p,{children:"It is not part of this guide to describe the registration with the individual cloud\nproviders. Please contact the respective cloud provider for this."}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Product"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Provider"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Profile name"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Note"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Cleura"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Cleura"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"cleura"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Fuga Cloud"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"FUGA"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"fuga"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"HuaweiCloud"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"HuaweiCloud"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"huaweicloud"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"OVH"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"OVH"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"ovh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"OpenTelekomCloud"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"T-Systems"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"otc"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"pluscloud open"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"plusserver"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"pluscloudopen"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"pluscloud SCS Test"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"plusserver"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"gx-scs"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"REGIO.cloud"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"OSISM"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"regiocloud"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"REGIO.cloud"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"OSISM"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"regio-fast"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"boot from NVMe SSD backed volumes"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Wavestack"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"noris network"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"wavestack"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"CNDS Cloud"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"artcodix"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"artcodix"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsxs)(t.p,{children:["For each cloud provider listed in the table, a predefined profile is available in the\n",(0,l.jsx)(t.code,{children:"terraform/environments"})," directory. This profile contains the name of the public\nnetwork, which flavors to use, etc."]}),"\n",(0,l.jsxs)(t.p,{children:["Here is an example from the profile for ",(0,l.jsx)(t.a,{href:"https://regio.digital",children:"REGIO.cloud"}),"."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-text",children:'flavor_manager            = "SCS-4V-16-50"\nflavor_node               = "SCS-8V-32-50"\nvolume_type               = "ssd"\nimage                     = "Ubuntu 22.04"\nimage_node                = "Ubuntu 22.04"\npublic                    = "public"\navailability_zone         = "nova"\nvolume_availability_zone  = "nova"\nnetwork_availability_zone = "nova"\n'})}),"\n",(0,l.jsx)(t.h3,{id:"cloud-resources",children:"Cloud resources"}),"\n",(0,l.jsx)(t.p,{children:"The OSISM Testbed requires at least the following project quota when using the default flavors:"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Quantity"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Resource"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Note"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"7"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Instances"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"52 VCPUs + 208 GByte RAM (6 modes, 1 manager)"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"18"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Volumes"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"360 GByte volume storage"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"1"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Floating IP"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"1"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Keypair"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"3"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Security group"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"16"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Security group rules"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"1"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Network"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"1"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Subetwork"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"6"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Ports"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"1"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Router"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(t.h3,{id:"software",children:"Software"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.code,{children:"make"})," must be installed on the system"]}),"\n",(0,l.jsxs)(t.li,{children:["Wireguard or ",(0,l.jsx)(t.code,{children:"sshuttle"})," must be installed on your system for VPN access"]}),"\n",(0,l.jsxs)(t.li,{children:["Python must be installed, the Python version used must be at least 3.10, otherwise\nthe current Ansible release cannot be used (details in the\n",(0,l.jsx)(t.a,{href:"https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html#ansible-core-support-matrix",children:"Ansible support matrix"}),")"]}),"\n",(0,l.jsxs)(t.li,{children:[(0,l.jsx)(t.code,{children:"python3-venv"})," must be installed for managing Python dependencies like Ansible"]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"deployment",children:"Deployment"}),"\n",(0,l.jsx)(t.p,{children:"This section describes step by step how to deploy the OSISM Testbed."}),"\n",(0,l.jsxs)(t.ol,{children:["\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"Request access from the administrator of the respective cloud or get access to an OpenStack cloud."}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Clone the ",(0,l.jsx)(t.a,{href:"https://github.com/osism/testbed",children:"osism/testbed"})," repository."]}),"\n",(0,l.jsx)(t.p,{children:"The repository can also be cloned to any other location."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"mkdir -p ~/src/github.com/osism\ngit clone https://github.com/osism/testbed ~/src/github.com/osism/testbed\ncd ~/src/github.com/osism/testbed\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"Configure your cloud access profile"}),"\n",(0,l.jsxs)(t.p,{children:["The access data for the cloud provider used is stored in ",(0,l.jsx)(t.code,{children:"terraform/clouds.yaml"})," and (optionally)\nin ",(0,l.jsx)(t.code,{children:"terraform/secure.yaml"})," (same structure, if you want to store credentials on a separate place)."]}),"\n",(0,l.jsxs)(t.p,{children:["In file ",(0,l.jsx)(t.a,{href:"https://github.com/osism/testbed/blob/main/terraform/clouds.yaml.sample",children:"terraform/clouds.yaml.sample"}),"\nyou will find examples of typical setups. Settings that are identical for all users of a cloud can be defined\ncentrally via the profiles of the file\n",(0,l.jsx)(t.a,{href:"https://github.com/osism/testbed/blob/main/terraform/clouds-public.yaml",children:"terraform/clouds-public.yaml"}),".\nYou can reference these settings by using the ",(0,l.jsx)(t.code,{children:"profile"})," parameter in cloud-specific\ndefinition in ",(0,l.jsx)(t.code,{children:"terraform/clouds.yaml"}),"."]}),"\n",(0,l.jsxs)(t.p,{children:["The user specific settings of the ",(0,l.jsx)(t.code,{children:"clouds.yaml"})," file are provided by the cloud provider. Please check the\ndocumentation  of the cloud provider you are using or their support for details."]}),"\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.a,{href:"https://regio.digital",children:"REGIO.cloud"})," is used as an example here. The cloud name in ",(0,l.jsx)(t.code,{children:"clouds.yaml"}),"\nand the environment name (value of ",(0,l.jsx)(t.code,{children:"ENVIRONMENT"}),") are ",(0,l.jsx)(t.code,{children:"regiocloud"})," in this case. It is important that\nthe name of the cloud in ",(0,l.jsx)(t.code,{children:"clouds.yaml"})," matches the name of the environment to be used. The names must\nbe identical. It is currently not possible to name the cloud ",(0,l.jsx)(t.code,{children:"regiocloud-123"})," in ",(0,l.jsx)(t.code,{children:"clouds.yaml"})," if the\nenvironment is ",(0,l.jsx)(t.code,{children:"regiocloud"}),"."]}),"\n",(0,l.jsxs)(t.p,{children:["If another cloud is used, replace ",(0,l.jsx)(t.code,{children:"regiocloud"})," with the respective profile name ",(0,l.jsx)(t.a,{href:"#cloud-access",children:"from the table above"}),"."]}),"\n",(0,l.jsxs)(r.A,{children:[(0,l.jsxs)(d.A,{value:"testbed-cloud-access-with-app-credentials",label:"Application Credentials",children:[(0,l.jsxs)(t.p,{children:["The use of application credentials is preferred. This way it is not necessary to store\ndetails like username, project name or sensitive information like the password in the\n",(0,l.jsx)(t.code,{children:"clouds.yaml"})," file."]}),(0,l.jsxs)(t.p,{children:["The application credentials can be found in Horizon under ",(0,l.jsx)(t.strong,{children:"Identity"}),". Use ",(0,l.jsx)(t.code,{children:"OSISM Testbed"})," as\nname and click ",(0,l.jsx)(t.code,{children:"Create Application Credential"}),"."]}),(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",metastring:'title="terraform/clouds.yaml"',children:'clouds:\n  regiocloud:\n    profile: regiocloud\n    auth:\n      application_credential_id: ID\n      application_credential_secret: SECRET\n    auth_type: "v3applicationcredential"\n'})}),(0,l.jsxs)(t.p,{children:["If you want to make use of ",(0,l.jsx)(t.code,{children:"terraform/secure.yaml"})," add your application credential secret there\ninstead of ",(0,l.jsx)(t.code,{children:"terraform/clouds.yaml"}),"."]}),(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",metastring:'title="terraform/secure.yaml"',children:"clouds:\n  regiocloud:\n    auth:\n      application_credential_secret: SECRET\n"})})]}),(0,l.jsxs)(d.A,{value:"testbed-cloud-access-with-username-password",label:"Username/Password",children:[(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",metastring:'title="terraform/clouds.yaml"',children:"clouds:\n  regiocloud:\n    profile: regiocloud\n    auth:\n      project_name: PROJECT\n      username: USERNAME\n      project_domain_name: DOMAIN\n      user_domain_name: DOMAIN\n"})}),(0,l.jsxs)(t.p,{children:["If you want to make use of ",(0,l.jsx)(t.code,{children:"terraform/secure.yaml"})," add your password there instead of ",(0,l.jsx)(t.code,{children:"terraform/clouds.yaml"}),"."]}),(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",metastring:'title="terraform/secure.yaml"',children:"clouds:\n  regiocloud:\n    auth:\n      password: PASSWORD\n"})})]})]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"Prepare the deployment."}),"\n",(0,l.jsxs)(t.p,{children:["The versions of Ansible and ",(0,l.jsx)(t.a,{href:"https://opentofu.org",children:"OpenTofu"})," are managed\nautomatically and necessary dependencies are cloned."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make prepare\n"})}),"\n",(0,l.jsxs)(t.p,{children:["If any error occurs during preparation and you want to run the preparation\nagain, it is important to run ",(0,l.jsx)(t.code,{children:"make wipe-local-install"})," first. Otherwise the\npreparation will not be redone completely and necessary parts will be missing\nlater on."]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"Create the infrastructure with OpenTofu."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make ENVIRONMENT=regiocloud create\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"Deploy the OSISM manager and bootstrap all nodes."}),"\n",(0,l.jsxs)(r.A,{children:[(0,l.jsx)(d.A,{value:"testbed-deploy-latst",label:"Deploy latest manager version",children:(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make ENVIRONMENT=regiocloud manager\n"})})}),(0,l.jsx)(d.A,{value:"testbed-deploy-stable",label:"Deploy a stable manager version",children:(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make ENVIRONMENT=regiocloud VERSION_MANAGER=8.0.1 manager\n"})})})]}),"\n",(0,l.jsxs)(t.p,{children:["Replace the version with the version you prefer.\nCheck the ",(0,l.jsx)(t.a,{href:"https://osism.tech/docs/release-notes/",children:"OSISM release notes"}),"\nto find out what's available."]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"After the bootstrap, you can log in to the manager via SSH."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make ENVIRONMENT=regiocloud login\n"})}),"\n",(0,l.jsx)(t.p,{children:"Yo can log in to the nodes of the cluster via the manager."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"osism console testbed-node-0\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"Deploy all services."}),"\n",(0,l.jsxs)(r.A,{children:[(0,l.jsxs)(d.A,{value:"testbed-deploy-multi-steps",label:"Deployment in single steps",children:[(0,l.jsxs)(t.p,{children:["It is also possible to deploy the services step by step on the\nmanager. To do this, first log in to the manager with ",(0,l.jsx)(t.code,{children:"make ENVIRONMENT=regiocloud login"}),"\nand then execute the deploy scripts one after the other. It is recommended to do this\nwithin a screen session."]}),(0,l.jsx)(t.p,{children:"Deploying the services takes some time and depends on how much bandwidth is available,\nhow the instances are equipped, etc. 90-120 minutes is not unusual when Ceph and OpenStack\nare fully deployed."}),(0,l.jsxs)(t.p,{children:["To speed up the Ansible playbooks, ",(0,l.jsx)(t.a,{href:"https://ara.recordsansible.org",children:"ARA"})," can be disabled. This\nis done by executing ",(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/disable-ara.sh"}),". Run this script ",(0,l.jsx)(t.strong,{children:"before"})," the deployment scripts.\nAfterwards no more logs are available in the ARA web\ninterface. To re-enable ARA use ",(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/enable-ara.sh"}),"."]}),(0,l.jsxs)(t.p,{children:["There is also the option of pre-population of images with ",(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/pull-images.sh"}),"\nso that deployments do not have to be lengthy. Run this script ",(0,l.jsx)(t.strong,{children:"before"})," the deployment scripts."]}),(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"/opt/configuration/scripts/deploy/001-helpers.sh\n/opt/configuration/scripts/deploy/100-ceph-with-ansible.sh\n/opt/configuration/scripts/deploy/200-infrastructure.sh\n/opt/configuration/scripts/deploy/300-openstack.sh\n/opt/configuration/scripts/deploy/400-monitoring.sh\n/opt/configuration/scripts/deploy/500-kubernetes.sh\n"})}),(0,l.jsxs)(t.p,{children:["Prepare OpenStack resources like public network, flavors and images by running\n",(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/bootstrap.sh"}),". Run this script ",(0,l.jsx)(t.strong,{children:"after"})," the deployment scripts."]}),(0,l.jsxs)(t.admonition,{type:"info",children:[(0,l.jsxs)(t.p,{children:["If you only want to deploy the monitoring services with ",(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/400-monitoring.sh"}),",\na few dependencies must be deployed first. You can then use the monitoring services without having to install a\ncomplete OpenStack & Ceph environment."]}),(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"osism apply common\nosism apply loadbalancer\nosism apply opensearch\nosism apply mariadb\n"})})]})]}),(0,l.jsxs)(d.A,{value:"testbed-deploy-single-step",label:"Deployment of all services",children:[(0,l.jsx)(t.p,{children:"In this single step deployment, Ceph, OpenStack and all necessary\ninfrastructure services (MariaDB, RabbitMQ, ...) are deployed.\nDepending on the cloud, the deployment will take some time. Up to two hours is not unusual."}),(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make ENVIRONMENT=regiocloud deploy\n"})})]})]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["If you want to verify the deployment with ",(0,l.jsx)(t.a,{href:"https://opendev.org/openinfra/refstack",children:"refstack"})," run\n",(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/check.sh"}),". This step will take some time and is optional."]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"The machine images required for the use of Kubernetes Cluster API and the amphora driver of OpenStack Octavia\nservice are not provided by default to save resources on the OSISM Testbed and improve deployment time.\nThese can be provisioned if required."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"/opt/configuration/scripts/bootstrap/301-openstack-octavia-amhpora-image.sh\n/opt/configuration/scripts/bootstrap/302-openstack-k8s-clusterapi-images.sh\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"If you want you can create a test project with a test user after login. It also\ncreates an instance with a volume attached to a network with a router. This step is optional."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"osism apply --environment openstack test\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"When the OSISM Testbed is no longer needed, it can be deleted."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make ENVIRONMENT=regiocloud clean\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(t.p,{children:"Deployment must be completed at this point."}),"\n",(0,l.jsx)(t.h3,{id:"custom-ca",children:"Custom CA"}),"\n",(0,l.jsxs)(t.p,{children:["The OSISM Testbed deployment currently uses hostnames in the domain ",(0,l.jsx)(t.code,{children:"testbed.osism.xyz"}),". This is a real domain\nand we provide the DNS records matching the addresses used in the OSISM Testbed, so that once you connect to your testbed via a direct\nlink or Wireguard, you can access hosts and servers by their hostname (e.g. ",(0,l.jsx)(t.code,{children:"ssh testbed-manager.testbed.osism.xyz"}),")."]}),"\n",(0,l.jsxs)(t.p,{children:["We also provide a wildcard TLS certificate signed by a custom CA for ",(0,l.jsx)(t.code,{children:"testbed.osism.xyz"})," and ",(0,l.jsx)(t.code,{children:"*.testbed.osism.xyz"}),".\nThis CA is always used for each testbed. The CA is not regenerated and it is not planned to change this for the next 10 years."]}),"\n",(0,l.jsxs)(t.p,{children:["In order for these certificates to be recognized locally as valid, the CA\n",(0,l.jsx)(t.a,{href:"https://raw.githubusercontent.com/osism/testbed/main/environments/kolla/certificates/ca/testbed.crt",children:"environments/kolla/certificates/ca/testbed.crt"}),"\nmust be imported locally."]}),"\n",(0,l.jsx)(t.h3,{id:"vpn-access",children:"VPN access"}),"\n",(0,l.jsx)(t.h4,{id:"wireguard",children:"Wireguard"}),"\n",(0,l.jsxs)(t.p,{children:["Install wireguard on your workstation, if you have not done this before. For instructions how to do\nit on your workstation, please have a look on the documentation of your used distribution. The\nwireguard documentation you will find ",(0,l.jsx)(t.a,{href:"https://www.wireguard.com",children:"here"}),"."]}),"\n",(0,l.jsx)(t.p,{children:"Start the wireguard tunnel.\n(Press CTRL+c to keep the tunnel running forever. The make target also launches a browser tab with references to all services)"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make vpn-wireguard ENVIRONMENT=regiocloud\n"})}),"\n",(0,l.jsx)(t.p,{children:"If you want to connect to the OSISM Testbed from multiple clients, change the client IP\naddress in the downloaded configuration file to be different on each client."}),"\n",(0,l.jsxs)(t.p,{children:["If you only want to download the Wireguard configuration, you can use the ",(0,l.jsx)(t.code,{children:"vpn-wireguard-config"}),"\ntarget. The configuration is then available in the file ",(0,l.jsx)(t.code,{children:"wg-testbed-regiocloud.conf"}),", for example."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make vpn-wireguard-config ENVIRONMENT=regiocloud\n"})}),"\n",(0,l.jsx)(t.h4,{id:"sshuttle",children:"sshuttle"}),"\n",(0,l.jsxs)(t.p,{children:["If you do not want to use Wireguard you can also work with ",(0,l.jsx)(t.a,{href:"https://github.com/sshuttle/sshuttle",children:"sshuttle"}),"."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"make vpn-sshuttle ENVIRONMENT=regiocloud\nkillall sshuttle\n"})}),"\n",(0,l.jsxs)(t.h3,{id:"static-entries-in-etchosts",children:["Static entries in ",(0,l.jsx)(t.code,{children:"/etc/hosts"})]}),"\n",(0,l.jsxs)(t.p,{children:["If you are unable to access the following domains, you can customize your local ",(0,l.jsx)(t.code,{children:"/etc/hosts"}),"\nwith the following static entries. This may be necessary, for example, if you use Pi-hole and\nall DNS entries from a public DNS with a non-public IP address are filtered."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"# OSISM Testbed hosts\n192.168.16.5   ara.testbed.osism.xyz             ara\n192.168.16.5   cgit.testbed.osism.xyz            cgit\n192.168.16.5   flower.testbed.osism.xyz          flower\n192.168.16.5   homer.testbed.osism.xyz           homer\n192.168.16.5   netbox.testbed.osism.xyz          netbox\n192.168.16.5   testbed-manager.testbed.osism.xyz testbed-manager\n192.168.16.5   nexus.testbed.osism.xyz           nexus\n192.168.16.5   phpmyadmin.testbed.osism.xyz      phpmyadmin\n192.168.16.9   api-int.testbed.osism.xyz         api-int\n192.168.16.10  testbed-node-0.testbed.osism.xyz  testbed-node-0\n192.168.16.11  testbed-node-1.testbed.osism.xyz  testbed-node-1\n192.168.16.12  testbed-node-2.testbed.osism.xyz  testbed-node-2\n192.168.16.13  testbed-node-3.testbed.osism.xyz  testbed-node-3\n192.168.16.14  testbed-node-4.testbed.osism.xyz  testbed-node-4\n192.168.16.15  testbed-node-5.testbed.osism.xyz  testbed-node-5\n192.168.16.16  testbed-node-6.testbed.osism.xyz  testbed-node-6\n192.168.16.17  testbed-node-7.testbed.osism.xyz  testbed-node-7\n192.168.16.18  testbed-node-8.testbed.osism.xyz  testbed-node-8\n192.168.16.19  testbed-node-9.testbed.osism.xyz  testbed-node-9\n192.168.16.100 keycloak.testbed.osism.xyz        keycloak\n192.168.16.254 api.testbed.osism.xyz             api\n"})}),"\n",(0,l.jsx)(t.h3,{id:"webinterfaces",children:"Webinterfaces"}),"\n",(0,l.jsxs)(t.p,{children:["All SSL enabled services within the OSISM Testbed use certs which are signed by the self-signed\n",(0,l.jsx)(t.a,{href:"https://raw.githubusercontent.com/osism/testbed/main/environments/kolla/certificates/ca/testbed.crt",children:"OSISM Testbed CA"}),"\n(Download the file and import it as certification authority to your browser)."]}),"\n",(0,l.jsx)(t.p,{children:"If you want to access the services please choose the URL from the following table."}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Name"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"URL"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Username"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Password"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Note"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"ARA"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://ara.testbed.osism.xyz",children:"https://ara.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"ara"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Ceph"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://api-int.testbed.osism.xyz:8140",children:"https://api-int.testbed.osism.xyz:8140"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"admin"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Flower"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://flower.testbed.osism.xyz",children:"https://flower.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}}),(0,l.jsx)(t.td,{style:{textAlign:"left"}}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Grafana"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://api-int.testbed.osism.xyz:3000",children:"https://api-int.testbed.osism.xyz:3000"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"admin"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"HAProxy (testbed-node-0)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"http://testbed-node-0.testbed.osism.xyz:1984",children:"http://testbed-node-0.testbed.osism.xyz:1984"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"openstack"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"HAProxy (testbed-node-1)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"http://testbed-node-1.testbed.osism.xyz:1984",children:"http://testbed-node-1.testbed.osism.xyz:1984"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"openstack"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"HAProxy (testbed-node-2)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"http://testbed-node-2.testbed.osism.xyz:1984",children:"http://testbed-node-2.testbed.osism.xyz:1984"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"openstack"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Homer"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://homer.testbed.osism.xyz",children:"https://homer.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}}),(0,l.jsx)(t.td,{style:{textAlign:"left"}}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Horizon (via Keystone)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://api.testbed.osism.xyz",children:"https://api.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"admin"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"domain: default"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Horizon (via Keystone)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://api.testbed.osism.xyz",children:"https://api.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"test"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"test"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"domain: test"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Netbox"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://netbox.testbed.osism.xyz",children:"https://netbox.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"admin"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Netdata"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"http://testbed-manager.testbed.osism.xyz:19999",children:"http://testbed-manager.testbed.osism.xyz:19999"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}}),(0,l.jsx)(t.td,{style:{textAlign:"left"}}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Nexus"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://nexus.testbed.osism.xyz",children:"https://nexus.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"admin"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"OpenSearch Dashboards"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://api.testbed.osism.xyz:5601",children:"https://api.testbed.osism.xyz:5601"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"opensearch"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Prometheus"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://api-int.testbed.osism.xyz:9091",children:"https://api-int.testbed.osism.xyz:9091"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"admin"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"RabbitMQ"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://api-int.testbed.osism.xyz:15672",children:"https://api-int.testbed.osism.xyz:15672"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"openstack"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"phpMyAdmin"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.a,{href:"https://phpmyadmin.testbed.osism.xyz",children:"https://phpmyadmin.testbed.osism.xyz"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"root"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"password"}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(t.h4,{id:"usage-of-the-openstack-cli",children:"Usage of the OpenStack CLI"}),"\n",(0,l.jsxs)(t.p,{children:["The ",(0,l.jsx)(t.code,{children:"environments/openstack"})," folder contains the needed files for the openstack client:"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"cd environments/openstack\nexport OS_CLOUD=<the cloud environment>  # i.e. admin\nopenstack floating ip list\n"})}),"\n",(0,l.jsx)(t.h2,{id:"advanced-usage",children:"Advanced Usage"}),"\n",(0,l.jsx)(t.h3,{id:"external-api",children:"External API"}),"\n",(0,l.jsxs)(t.p,{children:["It is possible to provide the OpenStack APIs and the OpenStack Dashboard via the manager's public IP address.\nThis is not enabled by default, with the exception of the OTC profile. To provide the OpenStack APIs and the\nOpenStack dashboard via the public IP address of the manager, the following changes are necessary in the\n",(0,l.jsx)(t.code,{children:"terraform/environments/regiocloud.tfvars"})," file. If a cloud other than the REGIO.cloud is used, the profile\nof the other cloud is changed accordingly."]}),"\n",(0,l.jsxs)(t.ol,{children:["\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Add the customisation ",(0,l.jsx)(t.code,{children:"external_api"}),". This customisation makes sure that the required security group rules\nare created for the various OpenStack APIs and the OpenStack dashboard."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"# customisation:external_api\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Set parameter ",(0,l.jsx)(t.code,{children:"external_api"})," to ",(0,l.jsx)(t.code,{children:"true"}),". This makes sure that all necessary changes are made in the configuration\nrepository when the manager service is deployed. It is correct that this is added as a comment."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"external_api = true\n"})}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["After the deployment of the manager service and the OpenStack services, the OpenStack APIs and the OpenStack\ndashboard can be reached via a DNS name. The service ",(0,l.jsx)(t.a,{href:"https://traefik.me",children:"traefik.me"})," is used for the DNS record.\nRun the following two commands on the manager node to get the DNS record."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:'$ source /opt/manager-vars.sh\n$ echo "api-${MANAGER_PUBLIC_IP_ADDRESS//./-}.traefik.me"\napi-80-158-46-219.traefik.me\n'})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(t.h3,{id:"change-versions",children:"Change versions"}),"\n",(0,l.jsxs)(t.ol,{children:["\n",(0,l.jsxs)(t.li,{children:["Go to ",(0,l.jsx)(t.code,{children:"/opt/configuration"})," on ",(0,l.jsx)(t.code,{children:"testbed-manager"})]}),"\n",(0,l.jsxs)(t.li,{children:["Run ",(0,l.jsx)(t.code,{children:"./scripts/set-openstack-version.sh 2024.2"})," to set the OpenStack version to ",(0,l.jsx)(t.code,{children:"2024.2"})]}),"\n",(0,l.jsxs)(t.li,{children:["Run ",(0,l.jsx)(t.code,{children:"./scripts/set-ceph-version.sh reef"})," to set the Ceph version to ",(0,l.jsx)(t.code,{children:"reef"})]}),"\n",(0,l.jsxs)(t.li,{children:["Run ",(0,l.jsx)(t.code,{children:"osism update manager"})," to update the manager service"]}),"\n"]}),"\n",(0,l.jsx)(t.h3,{id:"deploy-services",children:"Deploy services"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Script"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/000-manager.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/001-helpers.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/100-ceph-with-ansible.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Ceph with Ansible"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/100-ceph-with-rook.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Ceph with Rook"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/200-infrastructure.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/300-openstack.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/310-openstack-extended.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/400-monitoring.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/500-kubernetes.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy/510-clusterapi.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(t.h3,{id:"upgrade-services",children:"Upgrade services"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Script"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/100-ceph-with-ansible.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Ceph with Ansible"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/100-ceph-with-rook.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Ceph with Rook"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/200-infrastructure.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/300-openstack.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/310-openstack-extended.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/400-monitoring.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/500-kubernetes.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/upgrade/510-clusterapi.sh"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(t.h3,{id:"add-new-osd-in-ceph",children:"Add new OSD in Ceph"}),"\n",(0,l.jsx)(t.p,{children:"In the testbed, three volumes per node are provided for use by Ceph by default. Two of\nthese devices are used as OSDs during the initial deployment. The third device is intended\nfor testing the addition of a further OSD to the Ceph cluster."}),"\n",(0,l.jsxs)(t.ol,{children:["\n",(0,l.jsxs)(t.li,{children:["Add ",(0,l.jsx)(t.code,{children:"sdd"})," to ",(0,l.jsx)(t.code,{children:"ceph_osd_devices"})," in ",(0,l.jsx)(t.code,{children:"/opt/configuration/inventory/host_vars/testbed-node-0/ceph-lvm-configuration.yml"}),".\nThe following content is an example, the IDs look different everywhere. Do not copy 1:1\nbut only add ",(0,l.jsx)(t.code,{children:"sdd"})," to the file."]}),"\n"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-yaml",children:"---\n#\n# This is Ceph LVM configuration for testbed-node-0\n# generated by ceph-configure-lvm-volumes playbook.\n#\nceph_osd_devices:\n  sdb:\n    osd_lvm_uuid: 95a9a2e0-b23f-55b2-a04f-e02ddfc0e82a\n  sdc:\n    osd_lvm_uuid: 29899765-42bf-557b-ae9c-5c7c984b2243\n  sdd:\nlvm_volumes:\n- data: osd-block-95a9a2e0-b23f-55b2-a04f-e02ddfc0e82a\n  data_vg: ceph-95a9a2e0-b23f-55b2-a04f-e02ddfc0e82a\n- data: osd-block-29899765-42bf-557b-ae9c-5c7c984b2243\n  data_vg: ceph-29899765-42bf-557b-ae9c-5c7c984b2243\n"})}),"\n",(0,l.jsxs)(t.ol,{start:"2",children:["\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Run ",(0,l.jsx)(t.code,{children:"osism apply ceph-configure-lvm-volumes -l testbed-node-0"})]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Run ",(0,l.jsx)(t.code,{children:"cp /tmp/testbed-node-0-ceph-lvm-configuration.yml /opt/configuration/inventory/host_vars/testbed-node-0/ceph-lvm-configuration.yml"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Run ",(0,l.jsx)(t.code,{children:"osism reconciler sync"})]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Run ",(0,l.jsx)(t.code,{children:"osism apply ceph-create-lvm-devices -l testbed-node-0"})]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsxs)(t.p,{children:["Run ",(0,l.jsx)(t.code,{children:"osism apply ceph-osds -l testbed-node-0 -e ceph_handler_osds_restart=false"})]}),"\n"]}),"\n",(0,l.jsxs)(t.li,{children:["\n",(0,l.jsx)(t.p,{children:"Check the OSD tree"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"$ ceph osd tree\nID  CLASS  WEIGHT   TYPE NAME                STATUS  REWEIGHT  PRI-AFF\n-1         0.13640  root default\n-3         0.05846      host testbed-node-0\n 2    hdd  0.01949          osd.2                up   1.00000  1.00000\n 4    hdd  0.01949          osd.4                up   1.00000  1.00000\n 6    hdd  0.01949          osd.6                up   1.00000  1.00000\n-5         0.03897      host testbed-node-1\n 0    hdd  0.01949          osd.0                up   1.00000  1.00000\n 5    hdd  0.01949          osd.5                up   1.00000  1.00000\n-7         0.03897      host testbed-node-2\n 1    hdd  0.01949          osd.1                up   1.00000  1.00000\n 3    hdd  0.01949          osd.3                up   1.00000  1.00000\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(t.h3,{id:"ceph-via-rook-technical-preview",children:"Ceph via Rook (technical preview)"}),"\n",(0,l.jsxs)(t.p,{children:["Please have a look at ",(0,l.jsx)(t.a,{href:"/de/docs/guides/deploy-guide/services/ceph/rook",children:"Deploy Guide - Services - Rook"})," and ",(0,l.jsx)(t.a,{href:"/de/docs/guides/configuration-guide/rook",children:"Configuration Guide - Rook"})," for details on how to configure Rook."]}),"\n",(0,l.jsx)(t.p,{children:"To deploy this in the testbed, you can use an environment variable in your make target."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"make CEPH_STACK=rook manager\nmake CEPH_STACK=rook ceph\n"})}),"\n",(0,l.jsxs)(t.p,{children:["This will make sure ",(0,l.jsx)(t.code,{children:"/opt/manager-vars.sh"})," gets ",(0,l.jsx)(t.code,{children:"CEPH_STACK=rook"})," set which is later being used by:"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"/opt/configuration/scripts/deploy-services.sh\n/opt/configuration/scripts/deploy-ceph.sh\n/opt/configuration/scripts/upgrade/100-ceph-with-rook.sh\n"})}),"\n",(0,l.jsx)(t.h2,{id:"using-testbed-for-openstack-development",children:"Using testbed for OpenStack development"}),"\n",(0,l.jsxs)(t.p,{children:["Testbed may be used for doing development on OpenStack services through ",(0,l.jsx)(t.a,{href:"https://docs.openstack.org/kolla-ansible/latest/contributor/kolla-for-openstack-development.html",children:(0,l.jsx)(t.code,{children:"kolla_dev_mode"})}),".\n",(0,l.jsx)(t.code,{children:"kolla_dev_mode"})," may be activated for all supported service by adding"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"kolla_dev_mode: true\n"})}),"\n",(0,l.jsxs)(t.p,{children:["to ",(0,l.jsx)(t.code,{children:"environments/kolla/configuration.yml"}),". This will check out the ",(0,l.jsx)(t.code,{children:"git"})," repositories of all supported and enabled OpenStack services under ",(0,l.jsx)(t.code,{children:"/opt/stack"})," and bind mount them into the appropriate containers.\nSince this will fetch a lot of repositories it is advisable to enable this only selectively for the services you are going to work on. You can do so by adding a boolean variable to ",(0,l.jsx)(t.code,{children:"environments/kolla/configuration.yml"})," consisting of the service name and the suffix ",(0,l.jsx)(t.code,{children:"_dev_mode"}),", e.g.:"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"cinder_dev_mode: true\n"})}),"\n",(0,l.jsxs)(t.p,{children:["You may customise the used ",(0,l.jsx)(t.code,{children:"git"})," repository by adding ",(0,l.jsx)(t.code,{children:"kolla_repos_git"})," to ",(0,l.jsx)(t.code,{children:"environments/kolla/configuration.yml"})," to specify a common root for the repositories of all services, which will be completed by the service's name, e.g.:"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:'kolla_repos_git: "https://github.com/openstack"\n'})}),"\n",(0,l.jsxs)(t.p,{children:["will pull services from their ",(0,l.jsx)(t.code,{children:"github"})," mirror. E.g. pull nova from ",(0,l.jsx)(t.a,{href:"https://github.com/openstack/nova",children:"https://github.com/openstack/nova"}),"\nThe complete repository of a single service may be changed by adding a variable consisting of the service name and the suffix ",(0,l.jsx)(t.code,{children:"_git_repository"}),", e.g."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:'cinder_git_repository: "https://github.com/myorg/my_custom_cinder_fork"\n'})}),"\n",(0,l.jsxs)(t.p,{children:["You may Specify the ",(0,l.jsx)(t.code,{children:"git"})," reference globally by setting"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"kolla_source_version: my_feature_branch\n"})}),"\n",(0,l.jsxs)(t.p,{children:["in ",(0,l.jsx)(t.code,{children:"environments/kolla/configuration.yml"})," or for specific services via service name and suffix ",(0,l.jsx)(t.code,{children:"_source_version"}),", e.g."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"cinder_source_version: my_cinder_feature\n"})}),"\n",(0,l.jsxs)(t.p,{children:["In order to update the ",(0,l.jsx)(t.code,{children:"git"})," repositories on ",(0,l.jsx)(t.code,{children:"kolla-ansible"})," deployments set either"]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"kolla_dev_repos_pull: true\n"})}),"\n",(0,l.jsx)(t.p,{children:"or, e.g."}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{children:"cinder_dev_repos_pull: true\n"})}),"\n",(0,l.jsxs)(t.p,{children:["in ",(0,l.jsx)(t.code,{children:"environments/kolla/configuration.yml"})," to set the setting for all repositories or a service specific one."]}),"\n",(0,l.jsx)(t.p,{children:"Thus, as an example for a development workflow:"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["Create a ",(0,l.jsx)(t.code,{children:"git"})," mirror of the OpenStack service you want to work on"]}),"\n",(0,l.jsxs)(t.li,{children:["In ",(0,l.jsx)(t.code,{children:"environments/kolla/configuration.yml"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["Set the corresponding ",(0,l.jsx)(t.code,{children:"<service name>_dev_mode"})," variable to ",(0,l.jsx)(t.code,{children:"true"})]}),"\n",(0,l.jsxs)(t.li,{children:["Set the corresponding ",(0,l.jsx)(t.code,{children:"<service name>_git_repository"})," variable to your development mirror created above"]}),"\n",(0,l.jsxs)(t.li,{children:["Set the corresponding ",(0,l.jsx)(t.code,{children:"<service name>_source_version"})," variable to a branch name you intend to push your changes to"]}),"\n",(0,l.jsxs)(t.li,{children:["Set the corresponding ",(0,l.jsx)(t.code,{children:"<service name>_dev_repos_pull"})," variable to ",(0,l.jsx)(t.code,{children:"true"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(t.li,{children:"Commit your changes and push them to the specified branch in the specified mirror"}),"\n",(0,l.jsxs)(t.li,{children:["Run ",(0,l.jsx)(t.code,{children:"osism apply <service name>"})," on the manager to checkout the code on every testbed node"]}),"\n",(0,l.jsx)(t.li,{children:"Restart the service containers to actually pick up the new code"}),"\n"]}),"\n",(0,l.jsx)(t.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(t.h3,{id:"ansible-errors",children:"Ansible errors"}),"\n",(0,l.jsxs)(t.p,{children:["Ansible errors that have something to do with undefined variables (e.g. ",(0,l.jsx)(t.code,{children:"AnsibleUndefined"}),") are most likely due to cached\nfacts that are no longer valid. The facts can be updated by running ",(0,l.jsx)(t.code,{children:"osism apply facts"}),"."]}),"\n",(0,l.jsx)(t.h3,{id:"unsupported-locale-setting",children:"Unsupported locale setting"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"$ make prepare\nansible-playbook -i localhost, ansible/check-local-versions.yml\nERROR: Ansible could not initialize the preferred locale: unsupported locale setting\nmake: *** [prepare] Error 1\n"})}),"\n",(0,l.jsxs)(t.p,{children:["To solve the problem you have to modify the ",(0,l.jsx)(t.code,{children:"Makefile"}),". Change the 1st line as follows."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"export LC_ALL=en_US.UTF-8\n"})}),"\n",(0,l.jsxs)(t.p,{children:["To find out the locale used on the system ",(0,l.jsx)(t.code,{children:"printenv"})," can be used."]}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:'$ printenv | grep -i lang|locale\nLANG="en_US.UTF-8"\nLC_COLLATE="en_US.UTF-8"\nLC_CTYPE="UTF-8"\nLC_MESSAGES="en_US.UTF-8"\nLC_MONETARY="en_US.UTF-8"\nLC_NUMERIC="en_US.UTF-8"\nLC_TIME="en_US.UTF-8"\nLC_ALL=\n'})}),"\n",(0,l.jsx)(t.h2,{id:"appendix",children:"Appendix"}),"\n",(0,l.jsx)(t.h3,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsx)(t.p,{children:"This section describes how to configure and customise the OSISM Testbed."}),"\n",(0,l.jsx)(t.h4,{id:"variables",children:"Variables"}),"\n",(0,l.jsxs)(t.p,{children:["The defaults for the OpenTofu variables are intended for ",(0,l.jsx)(t.a,{href:"https://regio.digital",children:"REGIO.cloud"}),"."]}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Variable"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Note"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"availability_zone"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nova"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"ceph_version"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"quincy"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"cloud_provider"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"regiocloud"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"configuration_version"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"main"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"deploy_monitoring"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"false"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"dns_nameservers"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:'["8.8.8.8", "9.9.9.9"]'})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"enable_config_drive"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"true"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"external_api"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"false"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"flavor_manager"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"SCS-4V-16-50"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"flavor_node"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"SCS-8V-32-50"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"image"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"Ubuntu 22.04"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Only Ubuntu 22.04 is currently supported"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"image_node"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"Ubuntu 22.04"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Only Ubuntu 22.04 is currently supported"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"keypair"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"testbed"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"manager_version"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"latest"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"network_availability_zone"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nova"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"number_of_nodes"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"3"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"number_of_volumes"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"3"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"openstack_version"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"2023.2"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"prefix"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"testbed"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"public"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"external"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"refstack"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"false"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"volume_availability_zone"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nova"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"volume_size_base"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"30"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"volume_size_storage"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"10"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"volume_type"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"__DEFAULT__"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(t.h4,{id:"overrides",children:"Overrides"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Name"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"manager_boot_from_image"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"manager_boot_from_volume"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"neutron_availability_zone_hints_network"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"neutron_availability_zone_hints_router"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"neutron_router_enable_snat"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nodes_boot_from_image"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nodes_boot_from_volume"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"nodes_use_ephemeral_storage"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(t.h4,{id:"customisations",children:"Customisations"}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Name"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"access_floatingip"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"access_ipv4"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"access_ipv6"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"default"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"external_api"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"neutron_floatingip"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,l.jsx)(t.h3,{id:"notes",children:"Notes"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"The configuration is intentionally kept quite static. Please create no PRs to make the configuration more flexible/dynamic."}),"\n",(0,l.jsx)(t.li,{children:"The OSISM documentation uses hostnames, examples, addresses etc. from OSISM Testbed."}),"\n",(0,l.jsxs)(t.li,{children:["The third volume (",(0,l.jsx)(t.code,{children:"/dev/sdd"}),") is not enabled for Ceph by default. This is to test the scaling of Ceph."]}),"\n",(0,l.jsx)(t.li,{children:"The manager is used as pull through cache for Docker images and Ubuntu packages. This reduces the amount of traffic consumed."}),"\n"]}),"\n",(0,l.jsx)(t.h3,{id:"supported-releases",children:"Supported releases"}),"\n",(0,l.jsx)(t.p,{children:"The following stable Ceph and OpenStack releases are supported."}),"\n",(0,l.jsxs)(t.p,{children:["The deployment of Ceph is based on ",(0,l.jsx)(t.a,{href:"https://docs.ceph.com/ceph-ansible/",children:"ceph-ansible"}),"."]}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["Ceph Quincy (",(0,l.jsx)(t.strong,{children:"default"}),")"]}),"\n",(0,l.jsx)(t.li,{children:"Ceph Reef"}),"\n",(0,l.jsx)(t.li,{children:"Ceph Squid"}),"\n"]}),"\n",(0,l.jsxs)(t.p,{children:["The deployment of OpenStack is based on ",(0,l.jsx)(t.a,{href:"https://docs.openstack.org/kolla-ansible/latest/",children:"kolla-ansible"}),"."]}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"OpenStack 2023.1"}),"\n",(0,l.jsx)(t.li,{children:"OpenStack 2023.2"}),"\n",(0,l.jsxs)(t.li,{children:["OpenStack 2024.1 (",(0,l.jsx)(t.strong,{children:"default"}),")"]}),"\n"]}),"\n",(0,l.jsxs)(t.p,{children:["The deployment of Kubernetes is based on ",(0,l.jsx)(t.a,{href:"https://github.com/techno-tim/k3s-ansible",children:"k3s-ansible"}),"."]}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsxs)(t.li,{children:["Kubernetes v1.30 (",(0,l.jsx)(t.strong,{children:"default"}),")"]}),"\n"]}),"\n",(0,l.jsx)(t.h3,{id:"included-services",children:"Included services"}),"\n",(0,l.jsx)(t.p,{children:"The following services can currently be used with the OSISM Testbed without further adjustments."}),"\n",(0,l.jsx)(t.h4,{id:"infrastructure",children:"Infrastructure"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Ceph"}),"\n",(0,l.jsx)(t.li,{children:"Cluster API Management Cluster"}),"\n",(0,l.jsx)(t.li,{children:"Fluentd"}),"\n",(0,l.jsx)(t.li,{children:"Gnocchi"}),"\n",(0,l.jsx)(t.li,{children:"Grafana"}),"\n",(0,l.jsx)(t.li,{children:"Haproxy"}),"\n",(0,l.jsx)(t.li,{children:"Keepalived"}),"\n",(0,l.jsx)(t.li,{children:"Kubernetes"}),"\n",(0,l.jsx)(t.li,{children:"Mariadb"}),"\n",(0,l.jsx)(t.li,{children:"Memcached"}),"\n",(0,l.jsx)(t.li,{children:"Netbox"}),"\n",(0,l.jsx)(t.li,{children:"Netdata"}),"\n",(0,l.jsx)(t.li,{children:"Opensearch"}),"\n",(0,l.jsx)(t.li,{children:"Openvswitch"}),"\n",(0,l.jsx)(t.li,{children:"Prometheus exporters"}),"\n",(0,l.jsx)(t.li,{children:"Rabbitmq"}),"\n",(0,l.jsx)(t.li,{children:"Redis"}),"\n"]}),"\n",(0,l.jsx)(t.h4,{id:"openstack",children:"OpenStack"}),"\n",(0,l.jsxs)(t.ul,{children:["\n",(0,l.jsx)(t.li,{children:"Barbican"}),"\n",(0,l.jsx)(t.li,{children:"Ceilometer"}),"\n",(0,l.jsx)(t.li,{children:"Cinder"}),"\n",(0,l.jsx)(t.li,{children:"Designate"}),"\n",(0,l.jsx)(t.li,{children:"Glance"}),"\n",(0,l.jsx)(t.li,{children:"Horizon"}),"\n",(0,l.jsx)(t.li,{children:"Ironic"}),"\n",(0,l.jsx)(t.li,{children:"Keystone"}),"\n",(0,l.jsx)(t.li,{children:"Magnum"}),"\n",(0,l.jsx)(t.li,{children:"Manila"}),"\n",(0,l.jsx)(t.li,{children:"Neutron"}),"\n",(0,l.jsx)(t.li,{children:"Nova (with Libvirt/KVM)"}),"\n",(0,l.jsx)(t.li,{children:"Octavia"}),"\n",(0,l.jsx)(t.li,{children:"Skyline"}),"\n"]}),"\n",(0,l.jsx)(t.h3,{id:"makefile-reference",children:"Makefile reference"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-bash",children:"$ make help\n\nUsage:\n  make <target>\n  help                  Display this help.\n  clean                 Destroy infrastructure with OpenTofu.\n  wipe-local-install    Wipe the software dependencies in `venv`.\n  create                Create required infrastructure with OpenTofu.\n  login                 Log in on the manager.\n  vpn-wireguard         Establish a wireguard vpn tunnel.\n  vpn-sshuttle          Establish a sshuttle vpn tunnel.\n  bootstrap             Bootstrap everything.\n  manager               Deploy only the manager service.\n  identity              Deploy only identity services.\n  ceph                  Deploy only ceph services.\n  deploy                Deploy everything and then check it.\n  prepare               Run local preperations.\n  deps                  Install software preconditions to `venv`.\n\n$ make <TAB> <TAB>\n"})}),"\n",(0,l.jsx)(t.h3,{id:"ci-jobs",children:"CI jobs"}),"\n",(0,l.jsxs)(t.p,{children:["You can inspect the ",(0,l.jsx)(t.a,{href:"https://zuul.services.betacloud.xyz/t/osism/builds?project=osism%2Ftestbed&skip=0",children:"results of the daily zuul jobs"}),"."]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(x,{...e})}):x(e)}},9329:(e,t,s)=>{s.d(t,{A:()=>r});s(6540);var n=s(4164);const l={tabItem:"tabItem_Ymn6"};var i=s(4848);function r(e){let{children:t,hidden:s,className:r}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,n.A)(l.tabItem,r),hidden:s,children:t})}},5537:(e,t,s)=>{s.d(t,{A:()=>A});var n=s(6540),l=s(4164),i=s(5627),r=s(6347),d=s(372),o=s(604),c=s(1861),a=s(8749);function h(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function x(e){const{values:t,children:s}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:s,attributes:n,default:l}}=e;return{value:t,label:s,attributes:n,default:l}}))}(s);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,s])}function p(e){let{value:t,tabValues:s}=e;return s.some((e=>e.value===t))}function u(e){let{queryString:t=!1,groupId:s}=e;const l=(0,r.W6)(),i=function(e){let{queryString:t=!1,groupId:s}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return s??null}({queryString:t,groupId:s});return[(0,o.aZ)(i),(0,n.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(l.location.search);t.set(i,e),l.replace({...l.location,search:t.toString()})}),[i,l])]}function j(e){const{defaultValue:t,queryString:s=!1,groupId:l}=e,i=x(e),[r,o]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:s}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${s.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=s.find((e=>e.default))??s[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:i}))),[c,h]=u({queryString:s,groupId:l}),[j,f]=function(e){let{groupId:t}=e;const s=function(e){return e?`docusaurus.tab.${e}`:null}(t),[l,i]=(0,a.Dv)(s);return[l,(0,n.useCallback)((e=>{s&&i.set(e)}),[s,i])]}({groupId:l}),g=(()=>{const e=c??j;return p({value:e,tabValues:i})?e:null})();(0,d.A)((()=>{g&&o(g)}),[g]);return{selectedValue:r,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),h(e),f(e)}),[h,f,i]),tabValues:i}}var f=s(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=s(4848);function m(e){let{className:t,block:s,selectedValue:n,selectValue:r,tabValues:d}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),a=e=>{const t=e.currentTarget,s=o.indexOf(t),l=d[s].value;l!==n&&(c(t),r(l))},h=e=>{let t=null;switch(e.key){case"Enter":a(e);break;case"ArrowRight":{const s=o.indexOf(e.currentTarget)+1;t=o[s]??o[0];break}case"ArrowLeft":{const s=o.indexOf(e.currentTarget)-1;t=o[s]??o[o.length-1];break}}t?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.A)("tabs",{"tabs--block":s},t),children:d.map((e=>{let{value:t,label:s,attributes:i}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>{o.push(e)},onKeyDown:h,onClick:a,...i,className:(0,l.A)("tabs__item",g.tabItem,i?.className,{"tabs__item--active":n===t}),children:s??t},t)}))})}function b(e){let{lazy:t,children:s,selectedValue:i}=e;const r=(Array.isArray(s)?s:[s]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===i));return e?(0,n.cloneElement)(e,{className:(0,l.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:r.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function v(e){const t=j(e);return(0,y.jsxs)("div",{className:(0,l.A)("tabs-container",g.tabList),children:[(0,y.jsx)(m,{...t,...e}),(0,y.jsx)(b,{...t,...e})]})}function A(e){const t=(0,f.A)();return(0,y.jsx)(v,{...e,children:h(e.children)},String(t))}},8453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>d});var n=s(6540);const l={},i=n.createContext(l);function r(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);