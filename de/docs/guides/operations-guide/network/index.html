<!doctype html>
<html lang="de" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/operations-guide/network" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.0">
<title data-rh="true">Network | OSISM – Sovereign Cloud Platform</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://osism.tech/de/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://osism.tech/de/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://osism.tech/de/docs/guides/operations-guide/network"><meta data-rh="true" property="og:locale" content="de"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="de"><meta data-rh="true" name="docsearch:language" content="de"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Network | OSISM – Sovereign Cloud Platform"><meta data-rh="true" name="description" content="Modifying the network configuration"><meta data-rh="true" property="og:description" content="Modifying the network configuration"><link data-rh="true" rel="icon" href="/de/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://osism.tech/de/docs/guides/operations-guide/network"><link data-rh="true" rel="alternate" href="https://osism.tech/docs/guides/operations-guide/network" hreflang="en"><link data-rh="true" rel="alternate" href="https://osism.tech/de/docs/guides/operations-guide/network" hreflang="de"><link data-rh="true" rel="alternate" href="https://osism.tech/docs/guides/operations-guide/network" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Guides","item":"https://osism.tech/de/docs/guides/"},{"@type":"ListItem","position":2,"name":"Operations Guide","item":"https://osism.tech/de/docs/guides/operations-guide/"},{"@type":"ListItem","position":3,"name":"Network","item":"https://osism.tech/de/docs/guides/operations-guide/network"}]}</script><link rel="stylesheet" href="/de/assets/css/styles.76d018cd.css">
<script src="/de/assets/js/runtime~main.32a5f11c.js" defer="defer"></script>
<script src="/de/assets/js/main.869c3a83.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/de/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/de/"><div class="navbar__logo"><img src="/de/img/logo.svg" alt="OSISM Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/de/img/logo.svg" alt="OSISM Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/de/docs/">Documentation</a><a class="navbar__item navbar__link" href="/de/users">Users</a><a class="navbar__item navbar__link" href="/de/partners">Partners</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Deutsch</a><ul class="dropdown__menu"><li><a href="/docs/guides/operations-guide/network" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/de/docs/guides/operations-guide/network" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="de">Deutsch</a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="mailto:info@osism.tech?subject=OSISM Demo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Schedule a demo<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/de/docs/">Getting started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/de/docs/guides/">Guides</a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/concept-guide/">Concept Guide</a><button aria-label="Expand sidebar category &#x27;Concept Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/deploy-guide/">Deploy Guide</a><button aria-label="Expand sidebar category &#x27;Deploy Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/upgrade-guide/">Upgrade Guide</a><button aria-label="Expand sidebar category &#x27;Upgrade Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/configuration-guide/">Configuration Guide</a><button aria-label="Expand sidebar category &#x27;Configuration Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/de/docs/guides/operations-guide/">Operations Guide</a><button aria-label="Collapse sidebar category &#x27;Operations Guide&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/operations-guide/manager/">Manager</a><button aria-label="Expand sidebar category &#x27;Manager&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/operations-guide/ceph/">Ceph</a><button aria-label="Expand sidebar category &#x27;Ceph&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/de/docs/guides/operations-guide/infrastructure">Infrastructure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/de/docs/guides/operations-guide/network">Network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/operations-guide/openstack/">OpenStack</a><button aria-label="Expand sidebar category &#x27;OpenStack&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/de/docs/guides/operations-guide/package-upgrades">Package Upgrades</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/troubleshooting-guide/">Troubleshooting Guide</a><button aria-label="Expand sidebar category &#x27;Troubleshooting Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/user-guide/">User Guide</a><button aria-label="Expand sidebar category &#x27;User Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/developer-guide/">Developer Guide</a><button aria-label="Expand sidebar category &#x27;Developer Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/de/docs/guides/migration-guide/">Migration Guide</a><button aria-label="Expand sidebar category &#x27;Migration Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/de/docs/cloud-in-a-box/">Cloud in a Box</a><button aria-label="Expand sidebar category &#x27;Cloud in a Box&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/de/docs/testbed/">Testbed</a><button aria-label="Expand sidebar category &#x27;Testbed&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/de/docs/references/">References</a><button aria-label="Expand sidebar category &#x27;References&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/de/docs/release-notes/">Release Notes</a><button aria-label="Expand sidebar category &#x27;Release Notes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/de/docs/appendix/">Appendix</a><button aria-label="Expand sidebar category &#x27;Appendix&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/de/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/de/docs/guides/"><span>Guides</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/de/docs/guides/operations-guide/"><span>Operations Guide</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Network</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Network</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="modifying-the-network-configuration">Modifying the network configuration<a href="#modifying-the-network-configuration" class="hash-link" aria-label="Direct link to Modifying the network configuration" title="Direct link to Modifying the network configuration">​</a></h2>
<p>While the network layout of a production environment is mostly static,
sometimes it is necessary to make changes. There is however no guarantee that
the transition from one network configuration state to the next does not cause
interruptions to existing network flows. E.g. even very short down/up cycles of
interfaces may cause additional disturbances to SDN networks in upper layers,
which are not reconciled immediately or never at all.
Therefore it is required to move any existing payload when modifying the
network configuration of compute nodes. You may use the <code>osism</code> command
to achieve this, e.g.:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">osism manage compute migrate $COMPUTE_NODE</span><br></span></code></pre></div></div>
<p>Applying the network change is then limited to the empty compute node, e.g.:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">osism apply network --limit $COMPUTE_NODE</span><br></span></code></pre></div></div>
<p>While it is possible to make the changes effective immediately by appending
<code>--extra-vars network_allow_service_restart=true</code> to the command above, it is
recommended to make changes effective through restart of the node. The reason
for this is that some changes, like e.g. removal of an interface from
configuration, will not necessarily lead to it being removed, but just to it
being unmanaged. A reboot will ensure that only the actually defined network
configuration will be set up. You may use <code>osism</code> to reboot the node and wait
for it to come back up:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">osism apply reboot --limit $COMPUTE_NODE --extra-vars reboot_wait=true --extra-vars ireallymeanit=yes</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="internal-components">Internal components<a href="#internal-components" class="hash-link" aria-label="Direct link to Internal components" title="Direct link to Internal components">​</a></h2>
<p>OpenStack, OVN, and Open vSwitch all really like UUIDs.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openstack --os-cloud admin image list -f yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ID: d64f0b9d-0ea1-40b0-b879-b98e46fc7bcf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: Cirros 0.6.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Status: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ID: ee842bc5-dd29-4de5-a5db-1c9be759fe85</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: Cirros 0.6.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Status: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ID: cd28d95c-bd12-4e1e-8155-b9bf5ecbcb2f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: Cirros 0.6.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Status: active</span><br></span></code></pre></div></div>
<p>These UUIDs are great for uniqueness, but 36-character strings are terrible
for readability. Statistically, just the first few characters are enough for
uniqueness in small environments, so let’s define a helper to make things more
readable:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">abbrev() { a=&#x27;[0-9a-fA-F]&#x27; b=$a$a c=$b$b; sed &quot;s/$b-$c-$c-$c-$c$c$c//g&quot;; }</span><br></span></code></pre></div></div>
<p>You can use this as a filter to abbreviate UUIDs. For example, use it to abbreviate
the above image list:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openstack --os-cloud admin image list -f yaml | abbrev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ID: d64f0b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: Cirros 0.6.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Status: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ID: ee842b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: Cirros 0.6.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Status: active</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ID: cd28d9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Name: Cirros 0.6.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Status: active</span><br></span></code></pre></div></div>
<p>Source: <a href="https://docs.ovn.org/en/stable/tutorials/ovn-openstack.html#shortening-uuids" target="_blank" rel="noopener noreferrer">https://docs.ovn.org/en/stable/tutorials/ovn-openstack.html#shortening-uuids</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="open-vswitch-ovs">Open vSwitch (OVS)<a href="#open-vswitch-ovs" class="hash-link" aria-label="Direct link to Open vSwitch (OVS)" title="Direct link to Open vSwitch (OVS)">​</a></h2>
<ul>
<li><a href="https://gist.github.com/djoreilly/c5ea44663c133b246dd9d42b921f7646" target="_blank" rel="noopener noreferrer">https://gist.github.com/djoreilly/c5ea44663c133b246dd9d42b921f7646</a></li>
</ul>
<p>Open vSwitch on a network node with external network <code>vxlan0</code> and integration
with the Octavia service via <code>ohm0</code>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec -it openvswitch_vswitchd ovs-vsctl show</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2e6227aa-33f1-4762-8831-ab678ce7272d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Bridge br-int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fail_mode: secure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        datapath_type: system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port ovn-testbe-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interface ovn-testbe-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type: geneve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                options: {csum=&quot;true&quot;, key=flow, remote_ip=&quot;192.168.16.12&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port br-int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interface br-int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type: internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port ovn-testbe-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interface ovn-testbe-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type: geneve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                options: {csum=&quot;true&quot;, key=flow, remote_ip=&quot;192.168.16.11&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port tap8fe7d09b-90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interface tap8fe7d09b-90</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port ohm0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interface ohm0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type: internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Bridge br-ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port vxlan0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interface vxlan0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Port br-ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Interface br-ex</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                type: internal</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="open-virtual-network-ovn">Open Virtual Network (OVN)<a href="#open-virtual-network-ovn" class="hash-link" aria-label="Direct link to Open Virtual Network (OVN)" title="Direct link to Open Virtual Network (OVN)">​</a></h2>
<ul>
<li><a href="https://docs.ovn.org/en/stable/tutorials/ovn-openstack.html" target="_blank" rel="noopener noreferrer">https://docs.ovn.org/en/stable/tutorials/ovn-openstack.html</a></li>
</ul>
<p>Get OVN NB and OVN SB connection information from the <code>/etc/kolla/neutron-server/ml2_conf.ini</code>
file.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ovn_nb_connection=$(sudo grep -P -o -e &quot;(?&lt;=^ovn_nb_connection = ).*&quot; &quot;/etc/kolla/neutron-server/ml2_conf.ini&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ovn_sb_connection=$(sudo grep -P -o -e &quot;(?&lt;=^ovn_sb_connection = ).*&quot; &quot;/etc/kolla/neutron-server/ml2_conf.ini&quot;)</span><br></span></code></pre></div></div>
<p>The following examples are from a fresh <a href="https://github.com/osism/testbed" target="_blank" rel="noopener noreferrer">osism/testbed</a>
deployment with no payload running yet.</p>
<p>OVN NB DB entries:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec ovn_northd ovn-nbctl --db &quot;$ovn_nb_connection&quot; show | abbrev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">switch b5139b (neutron-8fe7d0) (aka lb-mgmt-net)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port 45a49e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: localport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        addresses: [&quot;fa:16:3e:fa:99:ea 10.1.0.2&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port 4d39a5 (aka octavia-listen-port-testbed-node-2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        addresses: [&quot;fa:16:3e:dc:11:e4 10.1.0.45&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port 8df1b7 (aka octavia-listen-port-testbed-node-0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        addresses: [&quot;fa:16:3e:4d:63:a9 10.1.0.43&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port ddb6aa (aka octavia-listen-port-testbed-node-1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        addresses: [&quot;fa:16:3e:67:f3:3d 10.1.0.40&quot;]</span><br></span></code></pre></div></div>
<p>OVN SB DB entries:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec ovn_northd ovn-sbctl --db &quot;$ovn_sb_connection&quot; show | abbrev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chassis testbed-node-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hostname: testbed-node-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Encap geneve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ip: &quot;192.168.16.10&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options: {csum=&quot;true&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port_Binding &quot;8df1b7&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chassis testbed-node-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hostname: testbed-node-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Encap geneve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ip: &quot;192.168.16.12&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options: {csum=&quot;true&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port_Binding &quot;4d39a5&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Chassis testbed-node-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hostname: testbed-node-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Encap geneve</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ip: &quot;192.168.16.11&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        options: {csum=&quot;true&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port_Binding &quot;ddb6aa</span><br></span></code></pre></div></div>
<p>OVN NB status:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec ovn_nb_db ovs-appctl -t /var/run/ovn/ovnnb_db.ctl cluster/status OVN_Northbound | abbrev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6d15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: OVN_Northbound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cluster ID: f5eb (f5ebd8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server ID: 6d15 (6d159e)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address: tcp:192.168.16.10:6643</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: cluster member</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Role: follower</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Term: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Leader: 87d6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vote: 87d6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last Election started 41049332 ms ago, reason: timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Election timer: 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Log: [2, 54]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Entries not yet committed: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Entries not yet applied: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connections: -&gt;21d7 -&gt;87d6 &lt;-87d6 &lt;-21d7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disconnections: 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    6d15 (6d15 at tcp:192.168.16.10:6643) (self)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    87d6 (87d6 at tcp:192.168.16.11:6643) last msg 266 ms ago</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    21d7 (21d7 at tcp:192.168.16.12:6643) last msg 41048563 ms ago</span><br></span></code></pre></div></div>
<p>OVN SB status:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker exec ovn_sb_db ovs-appctl -t /var/run/ovn/ovnsb_db.ctl cluster/status OVN_Southbound | abbrev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">be29</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: OVN_Southbound</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cluster ID: bd0c (bd0c26)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server ID: be29 (be2932)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Address: tcp:192.168.16.10:6644</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status: cluster member</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Role: follower</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Term: 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Leader: dfdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vote: unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last Election started 41063820 ms ago, reason: timeout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Election timer: 1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Log: [2, 62]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Entries not yet committed: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Entries not yet applied: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connections: -&gt;dfdf -&gt;085c &lt;-dfdf &lt;-085c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Disconnections: 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Servers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    be29 (be29 at tcp:192.168.16.10:6644) (self)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dfdf (dfdf at tcp:192.168.16.11:6644) last msg 146 ms ago</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    085c (085c at tcp:192.168.16.12:6644) last msg 41063293 ms ago</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="l3-high-availability">L3 high availability<a href="#l3-high-availability" class="hash-link" aria-label="Direct link to L3 high availability" title="Direct link to L3 high availability">​</a></h3>
<p>Router L3 high availability is built natively into OVN and does not require any actions from neutron. OVN routers are shown as &quot;HA&quot; in neutron, with the flag being immutable.</p>
<p>Nodes providing connection to external networks do have the <code>ovn-cms-options</code> key in their <code>Open_vSwitch</code> tables <code>external_ids</code> column set to <code>enable-chassis-as-gw</code>. This is done automatically in <code>osism</code> for all hosts in inventory group <code>ovn-controller-network</code>, which defaults to include all network nodes.
You can check this on any particular node by running</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker exec openvswitch_vswitchd ovs-vsctl get Open_vSwitch . external_ids:ovn-cms-options</span><br></span></code></pre></div></div>
<p>All nodes with the <code>ovn-cms-options=enable-chassis-as-gw</code> property take part in active/passive router gateway high availability.
Gateway chassis will monitor other gateway chassis and compute node chassis, while compute node chassis will monitor all gateway chassis, but not each other.
Monitoring is done using <a href="https://datatracker.ietf.org/doc/html/rfc5880" target="_blank" rel="noopener noreferrer">Bidirectional Forwarding Detection (BFD)</a> over the geneve tunnels established between each chassis.
Failures detected this way are</p>
<ul>
<li>Disconnection of the gateway chassis from the network used for tunneling:
The BFD signal will be disrupted, since it it being send over the tunnel network. It is therfore advisable to not use a different physical network as tunnel network.</li>
<li>Stop/Crash of <code>openvswitch_vswitchd</code>:
The daemon is the source of the BFD signal.</li>
<li>Graceful termination of ovn-controller
The OVN controller will unregister the chassis on being gracefully stopped.
Note, that sending SIGTERM does not initiate graceful shutdown of this service.</li>
</ul>
<p>Note that there is no detection of failures in the external network connectivity of a gateway chassis and subsequently no failover in this case!</p>
<p>For each router created in neutron a <code>Logical_Router</code> object is created in the OVN northd DB. The list can be retrived by connecting to one of the hosts running <code>ovn-northd</code></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker exec ovn_northd ovn-nbctl --db $ovn_nb_connection list Logical_Router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_uuid               : f0ea6a95-d4bd-40e0-9efd-6da197825981</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">copp                : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled             : true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external_ids        : {&quot;neutron:availability_zone_hints&quot;=&quot;&quot;, &quot;neutron:revision_number&quot;=&quot;5&quot;, &quot;neutron:router_name&quot;=test}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">load_balancer       : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">load_balancer_group : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name                : neutron-e9133cdd-7c31-4f67-8aac-a32384ce7939</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nat                 : [960ebe78-3f75-4f6e-bab4-c19522407d20, 982dc2bc-4536-4912-90fb-2aca7ba358c3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options             : {always_learn_from_arp_request=&quot;false&quot;, dynamic_neigh_routers=&quot;true&quot;, mac_binding_age_threshold=&quot;0&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">policies            : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ports               : [bc73e085-ea33-45a9-89cf-78f81625d172, edff2d86-3bdb-4396-a307-d7bfc69ac2d0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">static_routes       : [fa183064-0953-4c93-880a-78b049a8846f]</span><br></span></code></pre></div></div>
<p>The <code>ovn_nb_connection</code> is retrieved from the neutron ML2 configuration in the same as <a href="#open-virtual-network-ovn">described above</a>.</p>
<p>Finding the routers external gateway port directly may be achieved by searching the OVN&#x27;s <code>Logical_Router_Port</code> table for logical router ports having the <code>neutron:is_ext_gw=True</code> and <code>neutron:router_name=$Router_ID</code> in their <code>external_ids</code> column, where <code>$ROUTER_ID</code> is the ID of the router in neutron, which may also be found as part of the <code>name</code> in the OVN <code>Logical_Router</code> above.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ROUTER_ID=&quot;e9133cdd-7c31-4f67-8aac-a32384ce7939&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker exec ovn_northd ovn-nbctl --db $ovn_nb_connection find Logical_Router_Port external_ids:\&quot;neutron:is_ext_gw\&quot;=True external_ids:\&quot;neutron:router_name\&quot;=$ROUTER_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">_uuid               : bc73e085-ea33-45a9-89cf-78f81625d172</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled             : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external_ids        : {&quot;neutron:is_ext_gw&quot;=True, &quot;neutron:network_name&quot;=neutron-b7cb8fa6-10ee-4470-9212-95bb30390cc6, &quot;neutron:revision_number&quot;=&quot;322&quot;, &quot;neutron:router_name&quot;=&quot;e9133cdd-7c31-4f67-8aac-a32384ce7939&quot;, &quot;neutron:subnet_ids&quot;=&quot;9095ecb9-e32b-4ed7-8fdf-d9dd8bdaf50b&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gateway_chassis     : [06ce2cd0-b901-47c1-8bbd-889e16b1ae0f, cdf5423d-be53-44d4-b9cb-7df4138832b0, fadc4891-66ef-4478-b56c-66bf11cfff08]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ha_chassis_group    : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipv6_prefix         : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipv6_ra_configs     : {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mac                 : &quot;fa:16:3e:78:8c:d7&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name                : lrp-429c0111-ba3b-4641-b4ac-3fad8749e592</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">networks            : [&quot;192.168.112.179/20&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">options             : {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">peer                : []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">status              : {hosting-chassis=testbed-node-1}</span><br></span></code></pre></div></div>
<p>The <code>gateway_chassis</code> field in the output above shows the chassis currently involved providing high availability for the port and the <code>status</code> field shows the currently active chassis as the value of the <code>hosting-chassis</code> key.
At most five gateway chassis are used even if more nodes with external connectivity are available to keep BFD complexity low.
To look at the gateway chassis names and their priorities the bare list of gateway chassis from the command above may used to retrieve them specifically</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker exec ovn_northd ovn-nbctl --db=tcp:127.0.0.1:6641 --columns chassis_name,priority list Gateway_Chassis \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $(docker exec ovn_northd ovn-nbctl --db=tcp:127.0.0.1:6641 --bare --columns gateway_chassis find Logical_Router_Port external_ids:\&quot;neutron:is_ext_gw\&quot;=True external_ids:\&quot;neutron:router_name\&quot;=$ROUTER_ID)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chassis_name        : testbed-node-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">priority            : 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chassis_name        : testbed-node-0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">priority            : 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chassis_name        : testbed-node-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">priority            : 3</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="testing-ovn-router-l3-high-availability">Testing OVN router L3 high availability<a href="#testing-ovn-router-l3-high-availability" class="hash-link" aria-label="Direct link to Testing OVN router L3 high availability" title="Direct link to Testing OVN router L3 high availability">​</a></h4>
<ul>
<li>In a test installation create a test environment</li>
<li>Find the router ID and query the <code>hosting-chassis</code> as described above</li>
<li>Run a network test through the router, e.g. by pinging the external gateway</li>
<li>Connect to the hosting chassis and cause a failover by triggering one of the detected failures above</li>
<li>Observe change of the hosting-chassis as described above</li>
<li>Evaluate packet-loss in the network test</li>
</ul>
<p>During testing of the first two detected failures listed above (loss of tunnel network connectivity and stop of <code>openvswitch_vswitchd</code>) loss of a couple of ICMP echo replies was observed occasionally, while failback consistently resulted in loss of multiple ICMP echo replies.
During tests of graceful shutdown of <code>ovn-controller</code> no loss of ICMP replies was observed. Additionally no failback occured, but logical router port priorities were adapted instead, thus giving a seamless networking experience even during shutdown of network nodes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h4>
<p><a href="https://docs.openstack.org/neutron/latest/admin/ovn/refarch/refarch.html" target="_blank" rel="noopener noreferrer">https://docs.openstack.org/neutron/latest/admin/ovn/refarch/refarch.html</a>
<a href="https://docs.openstack.org/neutron/latest/admin/ovn/routing.html#l3ha-support" target="_blank" rel="noopener noreferrer">https://docs.openstack.org/neutron/latest/admin/ovn/routing.html#l3ha-support</a>
<a href="https://docs.openstack.org/neutron/latest/admin/ovn/l3_scheduler.html" target="_blank" rel="noopener noreferrer">https://docs.openstack.org/neutron/latest/admin/ovn/l3_scheduler.html</a>
<a href="https://docs.ovn.org/en/latest/topics/high-availability.html" target="_blank" rel="noopener noreferrer">https://docs.ovn.org/en/latest/topics/high-availability.html</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/osism/osism.github.io/tree/main/docs/guides/operations-guide/network.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/de/docs/guides/operations-guide/infrastructure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Infrastructure</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/de/docs/guides/operations-guide/openstack/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">OpenStack</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#modifying-the-network-configuration" class="table-of-contents__link toc-highlight">Modifying the network configuration</a></li><li><a href="#internal-components" class="table-of-contents__link toc-highlight">Internal components</a></li><li><a href="#open-vswitch-ovs" class="table-of-contents__link toc-highlight">Open vSwitch (OVS)</a></li><li><a href="#open-virtual-network-ovn" class="table-of-contents__link toc-highlight">Open Virtual Network (OVN)</a><ul><li><a href="#l3-high-availability" class="table-of-contents__link toc-highlight">L3 high availability</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/de/docs/appendix/comparisons">Comparisons</a></li><li class="footer__item"><a class="footer__link-item" href="/de/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/de/users">Users</a></li><li class="footer__item"><a class="footer__link-item" href="/de/partners">Partners</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">External links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/company/osism/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/osism" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/osism/issues/issues/new/choose" target="_blank" rel="noopener noreferrer" class="footer__link-item">Open issue on GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://zuul.services.betacloud.xyz/t/osism/status" target="_blank" rel="noopener noreferrer" class="footer__link-item">Zuul CI<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://regiocloud.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">REGIO.cloud<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.sovereigncloudstack.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sovereign Cloud Stack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/de/about-us">About Us</a></li><li class="footer__item"><a class="footer__link-item" href="/de/contact-us">Contact Us</a></li><li class="footer__item"><a href="mailto:info@osism.tech?subject=OSISM Demo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Schedule a demo<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/de/support">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/de/jobs">Jobs</a></li><li class="footer__item"><a class="footer__link-item" href="/de/privacy">Privacy Policy</a></li><li class="footer__item"><a class="footer__link-item" href="/de/terms">Terms &amp; Conditions</a></li><li class="footer__item"><a class="footer__link-item" href="/de/legals">Legals</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 OSISM GmbH. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>